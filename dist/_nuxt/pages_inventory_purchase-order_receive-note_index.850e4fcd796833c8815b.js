webpackJsonp([13],{BeO6:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("DVIK"),i=a("FRV0"),n=a("VU/8")(r.a,i.a,!1,null,null,null);n.options.__file="pages/inventory/purchase-order/receive-note/index.vue",e.default=n.exports},DVIK:function(t,e,a){"use strict";(function(t){var r=a("NeJI");e.a={layout:"main",components:{RecieveNotes:r.a},data:function(){return{formData:{merchID:"",description:"",vendorID:"",branchID:"",orderdate:"",duedate:"",purchaseID:"",notedetails:[]},errorData:{purchaseID:!1,orderdate:!1},poitems:[],vendors:[],branches:[],products:[],purchaseorder:"",purchaseOrders:[]}},computed:{recievedate:{set:function(t){this.$refs.recievenote.setDate(t),this.formData.orderdate=t,console.log("hey")},get:function(){return this.formData.orderdate}}},methods:{validate:function(){if(""==this.formData.purchaseID)return this.errorData.purchaseID=!0,!0;if(""==this.formData.orderdate)return this.errorData.orderdate=!0,!0;var t=this.formData.notedetails.filter(function(t){return""==t.receivedate});return t.length>0?(this.$toast.error("Recieve Date for products with the vendor codes "+t.map(function(t){return t.productname}).reduce(function(t,e){return t+=" "+curr})+" are empty"),!0):void 0},saveReceiveNote:function(){var e=this;this.formData.notedetails=this.poitems,this.validate()||(t("#submitBtn").attr("disabled",!0).html("Saving....."),this.$store.dispatch("purchaseorders/saveReceiveNote",this.formData).then(function(a){if(t("#submitBtn").attr("disabled",!1).html("+ Save Receive Note"),a.data.status)return e.$toast.success(a.data.message),e.$router.push("/inventory/purchase-order"),void(e.errorData={purchaseID:!1,orderdate:!1});e.$toast.error("An error occurred")}).catch(function(e){t("#submitBtn").attr("disabled",!1).html("+ Save Receive Note")}))},setReceiveNote:function(){var e=this,a=JSON.parse(localStorage.getItem("po_data")),r=JSON.parse(localStorage.getItem("receiveNote"));a&&function(){e.formData.purchaseID=a.id,e.formData.branchID=a.branchID,e.formData.vendorID=a.vendorID,e.formData.description=a.description,e.formData.duedate=e.$moment(a.duedate).format("YYYY-MM-DD"),console.log(r);var i=a.purchaseorderitems;e.purchaseorder=a.purchaseordercode;var n=r.receivenoteitems;if(n.length>0){for(var o=function(t){var r=i.find(function(e){return e.productID==n[t].productID}).quantity;e.poitems.push({productID:n[t].productID,quantity:n[t].quantity,quantityordered:r,outstanding:r-n[t].quantity,vendorproductcode:n[t].vendorproductcode,unitprice:n[t].unitprice,totalprice:n[t].totalprice,branchID:a.branchID,receivedate:n[t].receivedate,merchID:n[t].merchID})},s=0;s<n.length;s++)o(s);t(" input").prop("disabled",!0),t("select").prop("disabled",!0),t("textarea").prop("disabled",!0),t("#footer").hide(),t(".section-title").html("Goods Recieve Note For Purchase Order : "+a.purchaseordercode)}}()},addChild:function(){this.poitems.push({productID:"",quantity:"",vendorproductcode:"",unitprice:0,totalprice:0,branchID:"",receivedate:"",merchID:""})},removeChild:function(t){this.poitems.splice(t,1)},getBranches:function(){var t=this;this.$store.dispatch("branches/listBranches",this.formData.merchID).then(function(e){t.branches=e.data.data}).catch(function(t){console.log(t)})},getVendors:function(){var t=this;this.$store.dispatch("vendor/listVendors",this.formData.merchID).then(function(e){t.vendors=e.data.data}).catch(function(t){console.log(t)})},getProducts:function(){var t=this;this.$store.dispatch("products/listProducts",this.formData.merchID).then(function(e){t.products=e.data.data}).catch(function(t){console.log(t)})},setMerchID:function(t){this.poitems[t].merchID=this.formData.merchID},listPurchaseOrders:function(){var t=this;this.$store.dispatch("purchaseorders/listPurchaseOrder",this.formData.merchID).then(function(e){if(e.data.status)return t.purchaseOrders=e.data.data,void(t.loading=!1);t.$toast.error("An error occurred while retrieving records")}).catch(function(e){t.loading=!1,t.$toast.error("An error occurred while retrieving records")})},setPurchaseOrder:function(t){this.poitems=[],console.log(t.target.value);var e=this.purchaseOrders.find(function(e){return e.purchaseordercode==t.target.value});if(e){this.formData.purchaseID=e.id,this.formData.branchID=e.branchID,this.formData.vendorID=e.vendorID,this.formData.description=e.description,this.formData.duedate=this.$moment(e.duedate).format("YYYY-MM-DD");var a=e.purchaseorderitems;if(a.length>0){for(var r=0;r<a.length;r++)this.poitems.push({productID:a[r].productID,quantity:a[r].quantity,quantityordered:a[r].quantity,outstanding:0,vendorproductcode:a[r].vendorproductcode,unitprice:a[r].unitprice,totalprice:a[r].totalprice,total:a[r].totalprice,branchID:e.branchID,receivedate:"",merchID:a[r].merchID});console.log(this.poitems)}else this.addChild(),this.removeChild(1)}}},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.getProducts(),this.getBranches(),this.getVendors(),this.listPurchaseOrders(),this.setReceiveNote(),t(".disable").prop("disabled",!0)}}}).call(e,a("7t+N"))},"F/Fm":function(t,e,a){"use strict";var r=a("3EgV"),i=a.n(r);e.a={layout:"main",vuetify:new i.a,props:["poitems","type"],data:function(){return{snack:!1,snackColor:"green",snackText:"",pagination:{},headers:[{text:"Product",align:"end",sortable:!1,value:"productID"},{text:"Code",value:"vendorproductcode",align:"end",sortable:!1},{text:"Qty. Ordered",value:"quantityordered",align:"end",sortable:!1},{text:"Qty. Received",value:"quantity",align:"start",sortable:!1},{text:"Outstanding",value:"outstanding",align:"end",sortable:!1},{text:"Receive Date",value:"receivedate",align:"start",sortable:!1},{text:"Total Price",value:"totalprice",align:"end",sortable:!1},{text:"Cost / Piece",value:"unitprice",align:"end",sortable:!1},{text:"Actions",value:"actions",sortable:!1}],products:[]}},computed:{loading:function(){return!(this.poitems.length>0)},totalitems:function(){var t=this.poitems.map(function(t){return t.totalprice}).reduce(function(t,e){return t+=e},0);return console.log(t),t},totalprice:function(){var t=this.poitems.map(function(t){return t.total}).reduce(function(t,e){return t+=e},0);return console.log(t),t}},methods:{deleteItem:function(t){this.poitems.splice(this.poitems.indexOf(t),1)},calcDiscount:function(t){return(t.quantityordered*t.unitprice-Number(this.totalprice))/t.quantity},calcQty:function(t){t.quantity=t.packsize*t.packquantity,1==t.quantity&&0!=t.unitprice&&0!=t.packcost&&(t.quantity=t.packcost*t.packsize/t.unitprice)},calcPackQty:function(t){t.packquantity=t.quantity/t.packsize},calcPackCost:function(t){t.packcost=t.packsize*t.unitprice*t.packquantity},calcUnitPrice:function(t){t.unitprice=(t.totalprice+this.calcDiscount(t))/t.quantity},calculateTotal:function(t,e){switch(console.log(t),t.packsize=void 0!=t.packsize&&""!=t.packsize?Number(t.packsize):1,t.packquantity=void 0!=t.packquantity&&""!=t.packquantity?Number(t.packquantity):1,t.packcost=void 0!=t.packcost&&""!=t.packcost?Number(t.packcost):0,t.quantity=void 0!=t.quantity&&""!=t.quantity?Number(t.quantity):1,t.unitprice=void 0!=t.unitprice&&""!=t.unitprice?Number(t.unitprice):0,t.discountprice=void 0!=t.discountprice&&""!=t.discountprice?Number(t.discountprice):0,e){case"packsize":this.calcPackQty(t),this.calcQty(t);break;case"packquantity":this.calcQty(t);break;case"quantity":this.calcPackQty(t)}t.outstanding=t.quantityordered-t.quantity,t.totalprice=t.quantity*t.unitprice-this.calcDiscount(t)},getProductName:function(t){console.log(t);var e=this.products.find(function(e){return t.productID==e.id});return void 0!=e?(t.vendorproductcode=e.productcode,t.productcode=e.productcode,e.productname):"Select a Product"},save:function(t,e){"name"!=e&&this.calculateTotal(t,e),this.snack=!0,this.snackColor="success",this.snackText="Data saved"},cancel:function(){this.snack=!0,this.snackColor="error",this.snackText="Canceled"},open:function(){this.snack=!0,this.snackColor="info",this.snackText="Dialog opened"},close:function(){console.log("Dialog closed")},addChild:function(){this.poitems.unshift({id:"",productID:"",packsize:"",packquantity:"",packcost:"",quantity:"",quantityordered:"",outstanding:"",vendorproductcode:"",receivedate:"",unitprice:0,discountprice:0,totalprice:0,merchID:this.user.id})},removeChild:function(t){this.poitems.splice(t,1)},getProducts:function(){var t=this;this.$store.dispatch("products/listProducts",this.user.id).then(function(e){t.products=e.data.data}).catch(function(t){console.log(t)})},setDate:function(t){this.poitems.map(function(e){return""!=e.receivedate&&void 0!=e.receivedate||(e.receivedate=t),e})}},mounted:function(){console.log(this.poitems),this.getProducts()}}},FRV0:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-content-wrap"},[a("div",{staticClass:"d-flx-alc-jsb page-extras"},[a("p",{staticClass:"fw-medium font-16"},[a("nuxt-link",{staticClass:"text-link",attrs:{to:"/inventory/purchase-order"}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#back"}})]),a("span",{staticClass:"ml-1 fw-bold co-grey"},[t._v("Back")])])],1),a("div",{staticClass:"search-filter d-flx-alc-jfe"})]),a("div",{staticClass:"inner-main-wrapper"},[t._m(0),a("overlay-scrollbars",{staticClass:"table-wrapper no-deco"},[a("div",{staticClass:"mt-2"},[a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Purchase Order")]),a("div",{staticClass:"form-input__input"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.purchaseorder,expression:"purchaseorder"}],staticClass:"filter-btn box-deco-smallr",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.purchaseorder=e.target.multiple?a:a[0]},t.setPurchaseOrder]}},[a("option",{attrs:{value:""}},[t._v("-Select Purchase Order-")]),t._l(t.purchaseOrders,function(e){return a("option",{key:e.id,domProps:{value:e.purchaseordercode}},[t._v("\n                    "+t._s(e.purchaseordercode)+"\n                  ")])})],2)]),t.errorData.purchaseID?a("span",{staticClass:"form-input__error-msg"},[t._v("Please select a purchase order")]):t._e()])]),a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Branch")]),a("div",{staticClass:"form-input__input"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.branchID,expression:"formData.branchID"}],staticClass:"filter-btn box-deco-smallr disable",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"branchID",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("-Select Branch-")]),t._l(t.branches,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.branchname)+"\n                  ")])})],2)])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Vendor")]),a("div",{staticClass:"form-input__input"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.vendorID,expression:"formData.vendorID"}],staticClass:"filter-btn box-deco-smallr disable",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"vendorID",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("-Select Vendor-")]),t._l(t.vendors,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.vendorname)+"\n                  ")])})],2)])])]),a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Receive date")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.recievedate,expression:"recievedate"}],attrs:{type:"date",name:""},domProps:{value:t.recievedate},on:{input:function(e){e.target.composing||(t.recievedate=e.target.value)}}})]),t.errorData.orderdate?a("span",{staticClass:"form-input__error-msg"},[t._v("Please select a Recieve Date")]):t._e()]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Due date")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.duedate,expression:"formData.duedate"}],staticClass:"disable",attrs:{type:"date",name:""},domProps:{value:t.formData.duedate},on:{input:function(e){e.target.composing||t.$set(t.formData,"duedate",e.target.value)}}})])])]),a("RecieveNotes",{ref:"recievenote",attrs:{poitems:t.poitems,type:"recieveNotes"}}),a("div",{staticClass:"d-flx-alc-jfe mt-3",attrs:{id:"footer"}},[a("nuxt-link",{staticClass:"btn btn-no-fill",attrs:{to:"/inventory/purchase-order",type:"button"}},[t._v("\n              Cancel\n            ")]),a("button",{staticClass:"btn btn--primary ml-1",attrs:{type:"submit",id:"submitBtn"},on:{click:t.saveReceiveNote}},[t._v("\n              + Save Receive Note\n            ")])],1)],1)])],1)])};r._withStripped=!0;var i={render:r,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flx-alc-jsb table-title"},[e("h3",{staticClass:"section-title"},[this._v("Save Receive Note")])])}]};e.a=i},NeJI:function(t,e,a){"use strict";var r=a("F/Fm"),i=a("nwIQ"),n=!1;var o=function(t){n||a("sRK7")},s=a("VU/8")(r.a,i.a,!1,o,"data-v-2aed7601",null);s.options.__file="components/RecieveNotes.vue",e.a=s.exports},nwIQ:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-responsive",[a("v-data-table",{attrs:{headers:t.headers,"no-data-text":"No items in the list",items:t.poitems,loading:t.loading,"footer-props":{itemsPerPage:"200"}},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{staticClass:"text-right",attrs:{flat:""}},[a("v-toolbar-title",[t._v("Order Items")]),a("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),a("v-spacer")],1)]},proxy:!0},{key:"header.name",fn:function(e){var a=e.header;return[t._v("\n\t\t\t"+t._s(a.text.toUpperCase())+"\n\t\t\t")]}},{key:"item.productID",fn:function(e){return[t._v("\n                "+t._s(t.getProductName(e.item))+"\n\t\t\t\t")]}},{key:"item.quantity",fn:function(e){return[a("v-edit-dialog",{on:{cancel:t.cancel,open:t.open,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[a("v-text-field",{attrs:{type:"number",label:"Edit Qty","single-line":"",max:e.item.quantityordered,autofocus:""},on:{keyup:function(a){return t.save(e.item,"quantity")}},model:{value:e.item.quantity,callback:function(a){t.$set(e.item,"quantity",a)},expression:"props.item.quantity"}})]},proxy:!0}],null,!0)},[a("div",[t._v(t._s(t.formNumber(e.item.quantity)))])])]}},{key:"item.receivedate",fn:function(e){return[a("v-edit-dialog",{on:{cancel:t.cancel,open:t.open,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[a("v-text-field",{attrs:{type:"date",label:"Edit Receive Note","single-line":"",autofocus:""},model:{value:e.item.receivedate,callback:function(a){t.$set(e.item,"receivedate",a)},expression:"props.item.receivedate"}})]},proxy:!0}],null,!0)},[a("div",[t._v(t._s(""!=e.item.receivedate?t.$moment(e.item.receivedate).format("YYYY-MM-DD"):""))])])]}},{key:"item.totalprice",fn:function(e){return[a("div",[t._v(t._s(t.formatPrice(e.item.totalprice)))])]}},{key:"item.quantityordered",fn:function(e){return[a("div",[t._v(t._s(t.formNumber(e.item.quantityordered)))])]}},{key:"item.outstanding",fn:function(e){return[a("div",[t._v(t._s(t.formNumber(e.item.outstanding)))])]}},{key:"footer",fn:function(){return[a("v-col",{staticClass:"text-right smaller",attrs:{cols:"12"}},[t._v("\n\t\t\t\tTotal Received Value : "+t._s(t.totalitems)+"\n\t\t\t\t")]),a("v-col",{staticClass:"text-right smaller",attrs:{cols:"12"}},[t._v("\n\t\t\t\tTotal Price : "+t._s(t.totalprice)+"\n\t\t\t\t")])]},proxy:!0},{key:"item.actions",fn:function(e){var r=e.item;return[a("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(r)}}},[t._v("\n\t\t\t\t\tmdi-delete\n\t\t\t\t")])]}}])})],1)],1)};r._withStripped=!0;var i={render:r,staticRenderFns:[]};e.a=i},sRK7:function(t,e,a){var r=a("v5W+");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("2cd035b4",r,!1,{sourceMap:!1})},"v5W+":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".v-btn:not(.v-btn--round).v-size--default[data-v-2aed7601]{background-color:green!important}th[data-v-2aed7601]{font-size:10px!important}",""])}});