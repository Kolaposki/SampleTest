webpackJsonp([71],{RZvO:function(t,a,o){"use strict";var e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("overlay-scrollbars",{staticClass:"main-content-wrap"},[o("div",{staticClass:"d-flx-alc-jsb page-extras"},[o("p",{staticClass:"fw-medium font-16"}),o("div",{staticClass:"search-filter d-flx-alc-jfe"},[o("label",{staticClass:"search-w-icon"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:"Search"},domProps:{value:t.search},on:{input:function(a){a.target.composing||(t.search=a.target.value)}}}),o("svg",[o("use",{attrs:{href:"/uploads/icons.svg#search"}})])]),o("button",{staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:t.displayCreatePromoModal}},[t._v("\n          + Create PromoCode\n        ")]),o("div",{staticClass:"drop-down page-drop"}),o("div",{staticClass:"d-flx-alc"})])]),o("div",{attrs:{id:"parent-component"}},[o("div",{attrs:{container:"#parent-component",id:"add-promocode","uk-modal":""}},[o("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[o("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeAddPromoModal}}),o("div",{staticClass:"modal-header"},[o("h2",[t._v("Create Promocode")]),o("p",[t._v("Promo Codes to be used on the POS")])]),o("form",{on:{submit:function(a){return a.preventDefault(),t.savePromoCode.apply(null,arguments)}}},[o("overlay-scrollbars",{staticClass:"modal-body",attrs:{"uk-overflow-auto":""}},[o("div",{staticClass:"flex-width-1-2 less-gp"},[o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Promocode Title")]),o("div",{staticClass:"form-input__input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.promoData.title,expression:"promoData.title"}],attrs:{type:"text",required:""},domProps:{value:t.promoData.title},on:{input:function(a){a.target.composing||t.$set(t.promoData,"title",a.target.value)}}})]),t.promoErrorData.title?o("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a title")]):t._e()]),o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Code")]),o("div",{staticClass:"form-input__input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.promoData.code,expression:"promoData.code"}],attrs:{type:"text",required:"",disabled:""},domProps:{value:t.promoData.code},on:{input:function(a){a.target.composing||t.$set(t.promoData,"code",a.target.value)}}})])])]),o("div",{staticClass:"flex-width-1-2 less-gp"},[o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Amount")]),o("div",{staticClass:"form-input__input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.promoData.amount,expression:"promoData.amount"}],attrs:{min:"0",onkeypress:"return event.charCode >= 48",type:"number",required:""},domProps:{value:t.promoData.amount},on:{input:function(a){a.target.composing||t.$set(t.promoData,"amount",a.target.value)}}})]),t.promoErrorData.amount?o("span",{staticClass:"form-input__error-msg"},[t._v("Please enter an amount")]):t._e()])])]),o("div",{staticClass:"d-flx-alc-jfe mt-5"},[o("button",{staticClass:"btn btn-no-fill",attrs:{type:"button",id:"cancelBtn"},on:{click:t.closeAddPromoModal}},[t._v("\n                Cancel\n              ")]),o("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"submitBtn",type:"submit"}},[t._v("\n                + Create Promocode\n              ")])])],1)])]),o("div",{attrs:{container:"#parent-component",id:"edit-promocode","uk-modal":""}},[o("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[o("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeEditPromoModal}}),o("div",{staticClass:"modal-header"},[o("h2",[t._v("Update Promocode")]),o("p",[t._v("Update Promocode details.")])]),o("form",{on:{submit:function(a){return a.preventDefault(),t.updatePromocode.apply(null,arguments)}}},[o("overlay-scrollbars",{staticClass:"modal-body",attrs:{"uk-overflow-auto":""}},[o("div",{staticClass:"flex-width-1-2 less-gp"},[o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Promocode Title")]),o("div",{staticClass:"form-input__input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.editPromoData.title,expression:"editPromoData.title"}],attrs:{type:"text",required:""},domProps:{value:t.editPromoData.title},on:{input:function(a){a.target.composing||t.$set(t.editPromoData,"title",a.target.value)}}})]),t.promoErrorData.title?o("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a title")]):t._e()]),o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Code")]),o("div",{staticClass:"form-input__input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.editPromoData.code,expression:"editPromoData.code"}],attrs:{type:"text",required:"",disabled:""},domProps:{value:t.editPromoData.code},on:{input:function(a){a.target.composing||t.$set(t.editPromoData,"code",a.target.value)}}})])])]),o("div",{staticClass:"flex-width-1-2 less-gp"},[o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Amount")]),o("div",{staticClass:"form-input__input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.editPromoData.amount,expression:"editPromoData.amount"}],attrs:{min:"0",onkeypress:"return event.charCode >= 48",type:"number",required:""},domProps:{value:t.editPromoData.amount},on:{input:function(a){a.target.composing||t.$set(t.editPromoData,"amount",a.target.value)}}})])])]),o("label",{staticClass:"form-input"},[o("span",{staticClass:"form-input__label"},[t._v("Status")]),o("span",{staticClass:"font-14 co-lgray"},[t._v("Activate or Deactivate Promocode")]),o("div",{staticClass:"form-input__input"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.editPromoData.active,expression:"editPromoData.active"}],on:{change:function(a){var o=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.editPromoData,"active",a.target.multiple?o:o[0])}}},[o("option",{attrs:{value:"0"}},[t._v("Deactivate")]),o("option",{attrs:{value:"1"}},[t._v("Activate")])])])])]),o("div",{staticClass:"d-flx-alc-jfe mt-5"},[o("button",{staticClass:"btn btn-no-fill",attrs:{type:"button"},on:{click:t.closeEditPromoModal}},[t._v("\n                Cancel\n              ")]),o("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"updateBtn",type:"submit"}},[t._v("\n                + Update Promocode\n              ")])])],1)])])]),o("div",{staticClass:"inner-main-wrapper"},[t.loading?o("ul",[o("li",[o("div",{staticClass:"gifts-card"},[o("div",{staticClass:"gifts-card__extra"}),o("div",{staticClass:"gifts-card__title"},[t._v("\n              Loading...please wait\n            ")])])])]):t._e(),!t.loading&&t.promoList.length<1?o("ul",[o("li",[o("div",{staticClass:"gifts-card"},[o("div",{staticClass:"gifts-card__extra"}),o("div",{staticClass:"gifts-card__title"},[t._v("\n              No Promocodes have been created\n            ")])])])]):t._e(),!t.loading&&t.promoList.length>0?o("ul",{staticClass:"loyalty-list grid mostly-2"},t._l(t.promoList,function(a,e){return o("li",{key:e},[o("a",{staticClass:"loyalty-card",on:{click:function(a){return a.stopPropagation(),t.toggleDropdown(a)}}},[o("div",{staticClass:"loyalty-card__body"},[o("h3",[t._v("\n                "+t._s(a.title)+"\n              ")]),o("p",[t._v("Code : "+t._s(a.code)+" ")])]),o("div",{staticClass:"drop-down org-drop drop-set"},[o("div",{staticClass:"drop-wrapper",attrs:{"data-drop-down":""}},[o("ul",{staticClass:"drop-lists"},[o("li",{staticClass:"drop-list-item"},[o("button",{staticClass:"btn btn-text",attrs:{type:"button"},on:{click:function(o){return o.preventDefault(),t.copyLink(a.code)}}},[t._v("\n                      Copy Code\n                    ")])]),o("li",{staticClass:"drop-list-item"},[o("button",{staticClass:"btn btn-text",attrs:{type:"button"},on:{click:function(o){return o.preventDefault(),t.editLoyalty(a)}}},[t._v("\n                      Edit Details\n                    ")])])])])]),o("div",{staticClass:"loyalty-card__foot"},[o("p",{staticClass:"d-flx-alc"},[0==a.active?o("span",{staticClass:"status no-radius ended"},[t._v("Inactive")]):o("span",{staticClass:"status no-radius active"},[t._v("Active")]),o("svg",[o("use",{attrs:{"xlink:href":"/uploads/icons.svg#trophy"}})])])])])])}),0):t._e()])])};e._withStripped=!0;var s={render:e,staticRenderFns:[]};a.a=s},dvxq:function(t,a,o){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=o("oiGd"),s=o("RZvO"),r=o("VU/8")(e.a,s.a,!1,null,null,null);r.options.__file="pages/promocode/index.vue",a.default=r.exports},oiGd:function(t,a,o){"use strict";(function(t){a.a={layout:"main",computed:{promoList:function(){var t=this;return""==this.search?this.promocodes:this.promocodes.filter(function(a){return a.code.toLowerCase().includes(t.search.toLowerCase())||a.title.toLowerCase().includes(t.search.toLowerCase())})}},data:function(){return{loading:!0,search:"",status:"",promoData:{merchID:"",code:"",amount:"",title:"",active:1},promocode:{},options:[{id:1,text:"Activate"},{id:0,text:"Deactivate"}],promoErrorData:{loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:""},editPromoData:{merchID:"",code:"",amount:"",title:"",active:""},promocodes:[]}},methods:{copyLink:function(t){var a=this;this.$copyText(t).then(function(t){a.$toast.success("Code copied to clipboard")},function(t){a.$toast.error("An error occurred.Cannot copy.")})},savePromoCode:function(){var a=this,o={url:"/promocode",method:"post",params:{merchID:this.user.id},data:this.promoData};t("#submitBtn").attr("disabled",!0).html("Creating...please wait"),this.$store.dispatch("api/makeAPICall",o).then(function(o){if(t("#submitBtn").attr("disabled",!1).html("+ Create Promocode"),"True"===o.data.status)return a.$toast.success(o.data.message),a.closeAddPromoModal(),void a.listPromocodes();a.$toast.error(o.data.message)}).catch(function(o){t("#submitBtn").attr("disabled",!1).html("+ Create Promocode"),a.$toast.error("An error occurred")})},updatePromocode:function(){var a=this;t("#updateBtn").attr("disabled",!0).html("Updating...please wait"),this.editPromoData.active=1==Number(this.editPromoData.active)?1:0;var o={url:"/promocode",method:"put",params:{merchID:this.user.id},data:this.editPromoData};this.$store.dispatch("api/makeAPICall",o).then(function(o){if(t("#updateBtn").attr("disabled",!1).html("+ Update Promocode"),o.data.status)return a.$toast.success(o.data.message),a.closeEditPromoModal(),void a.listPromocodes();a.$toast.error(o.data.message)}).catch(function(o){t("#updateBtn").attr("disabled",!1).html("+ Update Promocode"),a.$toast.error("An error occurred")})},closeAddPromoModal:function(){this.clearErrorpromoData(),this.promoData.title="",this.promoData.amount="",this.promoData.code="",this.promoData.merchID=this.user.id,this.promoData.status="",UIkit.modal("#add-promocode").toggle("hide")},closeEditPromoModal:function(){this.editPromoData={merchID:this.user.id,code:"",title:"",amount:"",status:""},UIkit.modal("#edit-promocode").toggle("hide")},clearErrorpromoData:function(){this.promoErrorData={loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:"",status:"True"}},validatePromoAddRule:function(){return this.clearpromoErrorData(),""===this.promoData.loyaltyrule?(this.promoErrorData.loyaltyrule=!0,!0):""===this.promoData.rewardpoint?(this.promoErrorData.rewardpoint=!0,!0):""===this.promoData.amountspent?(this.promoErrorData.amountspent=!0,!0):""===this.promoData.startdate?(this.promoErrorData.startdate=!0,!0):""===this.promoData.endate&&(this.promoErrorData.endate=!0,!0)},listPromocodes:function(){var t=this,a={url:"/promocode",method:"get",params:{merchID:this.user.id}};this.$store.dispatch("api/makeAPICall",a).then(function(a){t.loading=!1,t.promocodes=a.data.data})},displayCreatePromoModal:function(){this.promoData.code=this.generateRefNumber(6).toUpperCase(),UIkit.modal("#add-promocode").toggle()},checkDate:function(t){return this.$moment().isAfter(t)},editLoyalty:function(t){this.promocode=t,this.editPromoData={merchID:this.user.id,amount:t.amount,code:t.code,title:t.title,startdate:t.startdate,endate:t.endate,active:1==t.active?1:0,id:t.id},UIkit.modal("#edit-promocode").toggle()}},mounted:function(){this.promoData.merchID=this.user.role?this.user.merchID:this.user.id,this.listPromocodes()}}}).call(a,o("7t+N"))}});