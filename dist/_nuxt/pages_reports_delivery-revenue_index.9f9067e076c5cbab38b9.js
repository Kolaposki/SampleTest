/*! For license information please see LICENSES */
webpackJsonp([28],{"06Gh":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("ZH8F"),s=a("Z5ls"),o=a("VU/8")(r.a,s.a,!1,null,null,null);o.options.__file="pages/reports/delivery-revenue/index.vue",e.default=o.exports},M2Sb:function(t,e,a){"use strict";e.a={layout:"main",props:["headers","value","date"],methods:{previous:function(){if(""!==this.headers.Prev){var t=+this.value-1;t<0?t=1:(this.$emit("input",t),this.$emit("go"))}},next:function(){if(""!==this.headers.Next){var t=+this.value+1;this.$emit("input",t),this.$emit("go")}}}}},Z5ls:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("overlay-scrollbars",{staticClass:"main-content-wrap"},[a("div",{staticClass:"d-flx-alc-jsb page-extras"},[a("nuxt-link",{staticClass:"text-link",attrs:{to:"/reports"}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#back"}})]),a("span",{staticClass:"ml-1 fw-bold co-grey"},[t._v("Back")])]),a("div",{staticClass:"search-filter d-flx-alc-jfe"},[a("label",{staticClass:"search-w-icon"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:"Search"},domProps:{value:t.search},on:{keyup:function(e){return t.filteredRevenue()},input:function(e){e.target.composing||(t.search=e.target.value)}}}),a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#search"}})])]),a("div",{staticClass:"drop-down filter-drop",attrs:{id:"branch"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.paymentMode,expression:"paymentMode"}],staticClass:"filter-btn box-deco-smallr",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.paymentMode=e.target.multiple?a:a[0]},function(e){return t.filterStatus()}]}},[a("option",{attrs:{value:""}},[t._v("All Payment mode")]),a("option",{attrs:{value:"card"}},[t._v("Card")]),a("option",{attrs:{value:"wallet"}},[t._v("Wallet")]),a("option",{attrs:{value:"cash"}},[t._v("Cash")]),a("option",{attrs:{value:"banktransfer"}},[t._v("Bank Transfer")])])]),a("div",{staticClass:"drop-down filter-drop"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.branchID,expression:"formData.branchID"}],staticClass:"filter-btn box-deco-smallr",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"branchID",e.target.multiple?a:a[0])},function(e){return t.getReport("branchID")}]}},[a("option",{attrs:{value:""}},[t._v("All Branches")]),t._l(t.branches,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n              "+t._s(e.branchname)+"\n            ")])})],2)]),a("div",{staticClass:"drop-down date-drop"},[a("date-picker",{attrs:{range:"",placeholder:"Date Range",type:"datetime",timeTitleFormat:"YYYY-MM-DD hh:mm a",format:"YYYY-MM-DD hh:mm a","value-type":"format","show-second":!1,"show-time-panel":t.showTimeRangePanel},on:{change:t.getReport,close:t.handleRangeClose},scopedSlots:t._u([{key:"footer",fn:function(){return[a("button",{staticClass:"mx-btn mx-btn-text",on:{click:t.toggleTimeRangePanel}},[t._v("\n\t\t\t\t\t\t"+t._s(t.showTimeRangePanel?"select date":"select time")+"\n\t\t\t\t\t")])]},proxy:!0}]),model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),a("download-excel",{staticClass:"btn btn--primary",attrs:{id:"download",fetch:t.fetchData,fields:t.json_fields,"before-generate":t.startDownload,"before-finish":t.finishDownload,worksheet:"My Worksheet",name:"delivery_revenue_report.xls"}},[t._v("\n          Export\n        ")])],1)],1),a("pagination",{attrs:{headers:t.headers,date:t.date},on:{go:t.getReport},model:{value:t.formData.page,callback:function(e){t.$set(t.formData,"page",e)},expression:"formData.page"}}),a("div",{staticClass:"inner-main-wrapper"},[a("div",{staticClass:"width-1-4"},[a("ul",{staticClass:"card-list none ml-mt-1 flex-width-1-4wgr"},[a("li",{staticClass:"card-item box-deco-bg",staticStyle:{"border-top":"3px solid forestgreen"}},[a("div",{staticClass:"card-item__header"},[a("div",[a("h3",[t._v("\n                    Gross Revenue\n                  ")])]),a("img",{attrs:{src:"/uploads/revenue-icon.png",width:"40px",alt:""}})]),a("div",{staticClass:"card-item__body"},[a("p",{staticClass:"card-item__body--count"},[t._v("₦"+t._s(t.formatPrice(t.totalrevenuefood+t.totalrevenuedelivery+t.totalrevenuepos)))])])]),a("li",{staticClass:"card-item box-deco-bg",staticStyle:{"border-top":"3px solid forestgreen"}},[a("div",{staticClass:"card-item__header"},[a("h3",[t._v("\n                  Total Revenue (Food)\n                ")]),a("img",{attrs:{src:"/uploads/revenue-icon.png",width:"40px",alt:""}})]),a("div",{staticClass:"card-item__body"},[a("p",{staticClass:"card-item__body--count"},[t._v("₦"+t._s(t.formatPrice(t.totalrevenuefood)))])])]),a("li",{staticClass:"card-item box-deco-bg",staticStyle:{"border-top":"3px solid forestgreen"}},[a("div",{staticClass:"card-item__header"},[a("div",[a("h3",[t._v("\n                    Total Revenue (Delivery)\n                  ")])]),a("img",{attrs:{src:"/uploads/revenue-icon.png",width:"40px",alt:""}})]),a("div",{staticClass:"card-item__body"},[a("p",{staticClass:"card-item__body--count"},[t._v("₦"+t._s(t.formatPrice(t.totalrevenuedelivery)))])])]),a("li",{staticClass:"card-item box-deco-bg",staticStyle:{"border-top":"3px solid forestgreen"}},[a("div",{staticClass:"card-item__header"},[a("h3",[t._v("\n                 Total Revenue (POS)\n                ")]),a("img",{attrs:{src:"/uploads/revenue-icon.png",width:"40px",alt:""}})]),a("div",{staticClass:"card-item__body"},[a("p",{staticClass:"card-item__body--count"},[t._v("₦"+t._s(t.formatPrice(t.totalrevenuepos)))])])])]),a("div")]),a("overlay-scrollbars",{staticClass:"table-wrapper"},[a("figcaption",{staticClass:"sr"},[t._v("\n          A table showing information of categories\n        ")]),a("table",{staticClass:"table-content"},[a("thead",{},[a("tr",[a("th",{staticClass:" column-name"},[t._v("Date")]),a("th",{staticClass:"column-name"},[t._v("Product")]),a("th",{staticClass:"column-name"},[t._v("Location")]),a("th",{staticClass:"column-name"},[t._v("Payment Mode")]),a("th",[t._v("Amount (₦)")])])]),a("tbody",{staticClass:"tablebody"},[t.loading?a("tr",[a("td",{attrs:{colspan:"10"}},[t._v("Loading...please wait")])]):t._e(),!t.loading&&t.filteredList.length<1?a("tr",[a("td",{attrs:{colspan:"10"}},[t._v("No record at the moment")])]):t._e(),t._l(t.filteredList,function(e,r){return!t.loading&&t.filteredList.length>0?a("tr",{key:r},[a("td",{staticClass:"column-name"},[t._v(t._s(e.created_at?t.$moment(e.created_at).format("Do MMM, YYYY HH:mm"):"N/A"))]),a("td",{staticClass:"column-name"},[t._v(t._s(e.product))]),a("td",{staticClass:"column-name"},[t._v(t._s(e.location))]),a("td",{staticClass:"column-name"},[t._v(" "+t._s(e.paymentmethod?e.paymentmethod:"N/A"))]),a("td",[t._v(" "+t._s(t.formatPrice(e.ordertotal)))])]):t._e()})],2)])])],1)],1)};r._withStripped=!0;var s={render:r,staticRenderFns:[]};e.a=s},ZH8F:function(t,e,a){"use strict";var r=a("hYtS");a("/5sW");e.a={components:{Pagination:r.a,"vue-datetime-picker":a("i0ln")},layout:"main",computed:{json_fields:function(){var t=this,e=this;return{Date:{callback:function(e){return t.$moment(e.created_at).format("Do MMM, YYYY HH:mm")}},Location:"location",Product:"product","Mode of Payment":"paymentmethod",Amount:{field:"ordertotal",callback:function(t){return e.formatPrice(t)}}}}},data:function(){return{paymentMode:"",totalrevenuepos:"",totalrevenuedelivery:"",totalrevenuefood:"",filteredList:[],loading:!0,search:"",result:"",dailyTotal:"",reports:[],branches:[],date:"",formData:{merchID:"",branchID:"",startdate:"",enddate:"",paymentmode:"",riderID:""},headers:{Next:"",Prev:"",Count:0,total:0,pagenum:1},api:"usersreport/getRevenueReport"}},methods:{filterStatus:function(){var t=this;this.filteredList=this.reports.filter(function(e){return""==t.paymentMode?t.reports:null!=e.paymentmethod&&e.paymentmethod.toLowerCase().includes(t.paymentMode.toLowerCase())?e.paymentmethod.toLowerCase().includes(t.paymentMode.toLowerCase()):void 0})},filteredRevenue:function(){var t=this;this.filteredList=this.reports.filter(function(e){return""==t.search?t.reports:null!=e.riderID&&e.riderID==t.search?e.riderID==t.search:void 0})},formatNumber:function(t){return(new Intl.NumberFormat).format(t)},getReport:function(t){var e=this;void 0!=t&&"branchID"==t&&(this.formData.page=1),this.loading=!0,""!==this.date&&null!=this.date[0]?(this.formData.startdate=this.$moment(this.date[0]).format("YYYY-MM-DD"),this.formData.enddate=this.$moment(this.date[1]).format("YYYY-MM-DD")):(this.formData.startdate="",this.formData.enddate="");this.formData.export="",this.$store.dispatch("usersreport/getRevenueReport",this.formData).then(function(t){if(console.log("res",t),t.status)return e.reports=t.data,e.filteredList=t.data,e.totalrevenuepos=t.totalposamount,e.totalrevenuefood=t.totalfoodamount,e.totalrevenuedelivery=t.totaldeliveryamount,e.setHeaders(t.data,t),void(e.loading=!1);e.loading=!1,e.$toast.error("An error occurred")}).catch(function(t){e.$toast.error("An error occurred "+t)})},listBranches:function(){var t=this;this.$store.dispatch("branches/listBranches",this.formData.merchID).then(function(e){t.branches=e.data.data}).catch(function(t){console.log(t)})},getDailySales:function(){var t=this;this.$store.dispatch("salesreport/getDailySales",this.formData).then(function(e){t.dailyTotal=e.data.data}).catch(function(t){console.log(t)})}},beforeRouteEnter:function(t,e,a){var r=JSON.parse(localStorage.getItem("user"));void 0==r.role||r.rolepermission&&r.rolepermission[0].reports.viewdeliveryrevenue?a():(alert("You have not been permitted to view this page"),a({path:"/dashboard"}))},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.getReport(),this.listBranches()}}},hYtS:function(t,e,a){"use strict";var r=a("M2Sb"),s=a("zTfd"),o=a("VU/8")(r.a,s.a,!1,null,null,null);o.options.__file="components/Pagination.vue",e.a=o.exports},i0ln:function(t,e,a){(function(t){!function(t){function e(r){if(a[r])return a[r].exports;var s=a[r]={exports:{},id:r,loaded:!1};return t[r].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var a={};e.m=t,e.c=a,e.p="",e(0)}([function(e,a){var r=["today","clear","close","selectMonth","prevMonth","nextMonth","selectYear","prevYear","nextYear","selectDecade","prevDecade","nextDecade","prevCentury","nextCentury","pickHour","incrementHour","decrementHour","pickMinute","incrementMinute","decrementMinute","pickSecond","incrementSecond","decrementSecond","togglePeriod","selectTime"];e.exports={replace:!0,inherit:!1,template:"<div class='input-group date'><input class='form-control' :name='name' type='text' /><span class='input-group-addon'><i class='fa fa-fw fa-calendar'></i></span></div>",props:{model:{required:!0,twoWay:!0},type:{type:String,required:!1,default:"datetime"},language:{type:String,required:!1,default:""},datetimeFormat:{type:String,required:!1,default:"YYYY-MM-DD HH:mm:ss"},dateFormat:{type:String,required:!1,default:"YYYY-MM-DD"},timeFormat:{type:String,required:!1,default:"HH:mm:ss"},name:{type:String,required:!1,default:""},onChange:{required:!1,default:null}},beforeCompile:function(){this.isChanging=!1,this.control=null},ready:function(){var e={useCurrent:!1,showClear:!0,showClose:!1,icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"fa fa-dot-circle-o",clear:"fa fa-trash",close:"fa fa-times"}},a=this.language;switch(null!==a&&""!==a||(this.$language?a=this.$language:langauge="en-US"),e.locale=this.getLanguageCode(a),this.type){case"date":e.format=this.dateFormat;break;case"time":e.format=this.timeFormat;break;case"datetime":default:e.format=this.datetimeFormat}if(this.$i18n&&this.$i18n.datetime_picker){for(var s=this.$i18n.datetime_picker,o=t.fn.datetimepicker.defaults.tooltips,n=0;n<r.length;++n){var i=r[n];s[i]&&(o[i]=s[i])}e.tooltips=o}t(this.$el).datetimepicker(e),this.control=t(this.$el).data("DateTimePicker"),this.control.date(this.model);var l=this;t(this.$el).on("dp.change",function(){l.isChanging||(l.isChanging=!0,l.model=l.control.date(),l.$nextTick(function(){l.isChanging=!1,l.onChange&&l.onChange(l.model)}))})},watch:{model:function(t,e){this.isChanging||(this.isChanging=!0,this.control.date(t),this.isChanging=!1,this.onChange&&this.onChange(t))}},methods:{getLanguageCode:function(t){if(null===t||0===t.length)return"en";if(t.length<=2)return t;switch(t){case"zh-CN":case"zh-TW":case"ar-MA":case"ar-SA":case"ar-TN":case"de-AT":case"en-AU":case"en-CA":case"en-GB":case"fr-CA":case"hy-AM":case"ms-MY":case"pt-BR":case"sr-CYRL":case"tl-PH":case"tzm-LATN":case"tzm":return t.toLowerCase();default:return t.substr(0,2)}}}}}])}).call(e,a("7t+N"))},zTfd:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flx-alc-jsb page-extras"},[a("div",{staticClass:"drop-down page-drop"},[a("button",{staticClass:"btn-text ",attrs:{type:"button"}},[t._v("\n          Showing "),a("span",[t._v(" "+t._s(t.showing)+" ")]),t._v(" of "),a("span",[t._v(" "+t._s(void 0!=this.headers.Count?this.headers.Count:0)+" ")])])]),a("div",{staticClass:"d-flx-alc"},[t.date&&"object"==typeof t.date?a("div",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.date[0])+" - "+t._s(t.date[1]))]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:"string"==typeof t.date,expression:"typeof date == 'string'"}],staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.date)+" ")]),a("button",{staticClass:"btn btn-icon smallsvg",on:{click:t.previous}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#arrow-right"}})])]),a("button",{staticClass:"btn btn-icon smallsvg",on:{click:t.next}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#arrow-left"}})])])])])};r._withStripped=!0;var s={render:r,staticRenderFns:[]};e.a=s}});