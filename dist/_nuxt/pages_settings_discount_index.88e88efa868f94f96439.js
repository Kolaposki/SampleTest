webpackJsonp([30],{BGUl:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("overlay-scrollbars",{staticClass:"main-content-wrap"},[a("overlay-scrollbars",{staticClass:"page-extras d-flx-alc-jsb settings-extra"},[a("div",{staticClass:"links-wrap"},[a("nuxt-link",{attrs:{to:"/settings"}},[t._v("Business Rules")]),t.user.rolepermission&&t.user.rolepermission[0].tax.viewtax||t.isMerchant?a("nuxt-link",{attrs:{to:"/settings/tax"}},[t._v("Tax")]):t._e(),t.user.rolepermission&&t.user.rolepermission[0].discounts.viewdiscount||t.isMerchant?a("nuxt-link",{staticClass:"active",attrs:{to:"/settings/discount"}},[t._v("Discount")]):t._e(),t.user.rolepermission&&t.user.rolepermission[0].settings.viewroles||t.isMerchant?a("nuxt-link",{attrs:{to:"/settings/roles"}},[t._v("Roles & Permissions")]):t._e(),t.user.rolepermission&&t.user.rolepermission[0].settings.viewlease||t.isMerchant?a("nuxt-link",{attrs:{to:"/settings/lease"}},[t._v("Lease")]):t._e()],1)]),a("div",{attrs:{id:"parent-component"}},[a("div",{attrs:{id:"delete-text","uk-modal":"",container:"#parent-component","data-uk-modal":"{target:'#delete-text',bgclose:false}"}},[a("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical small-modal"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button"},on:{click:t.cancelDelete}},[t._v("X")]),a("div",{staticClass:"modal-header d-flx"},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#co-delete"}})]),a("div",{staticClass:"ml-1"},[a("h2",[t._v("Remove Discount ?")]),a("p",[t._v("Please confirm you really want to delete this Discount, this action cannot be undone.")])])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"d-flx-alc-jc mt-3"},[a("button",{staticClass:"btn btn-no-fill",on:{click:t.cancelDelete}},[t._v("\n                Cancel\n              ")]),a("button",{staticClass:"btn btn-error ml-2",attrs:{id:"deleteDiscount"},on:{click:t.doDelete}},[t._v("\n                Delete\n              ")])])])])])]),a("div",{staticClass:"inner-main-wrapper"},[a("div",{staticClass:" py-3 px-0"},[a("section",{staticClass:"setting-section"},[a("div",{staticClass:"setting-section-title d-flx-alc-jsb"},[a("h2",{staticClass:"section-title"},[t._v("Discount ")]),t.user.rolepermission&&t.user.rolepermission[0].discounts.adddiscount||t.isMerchant?a("button",{staticClass:"btn btn-no-fill",attrs:{type:"button",disabled:""},on:{click:t.openModal}},[t._v("\n              Add  Discount\n            ")]):t._e()])])])]),a("div",{attrs:{id:"add-tax","uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeModal}}),a("div",{staticClass:"modal-header"},[a("h2",[t._v("Discount Amount")]),a("p",[t._v("Enter the details to create a new Discount. You can only add one discount type per product")])]),a("form",{staticClass:"mt-2",on:{submit:function(e){return e.preventDefault(),t.createDiscount.apply(null,arguments)}}},[t._l(t.discountdata.discountfee,function(e,s){return a("div",{key:s},[a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Product")]),a("div",{staticClass:"form-input__input"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.productID,expression:"input.productID"}],staticClass:"filter-btn box-deco-smallr",attrs:{required:""},on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(e,"productID",a.target.multiple?s:s[0])}}},[a("option",{attrs:{value:""}},[t._v("-Select Product-")]),t._l(t.products,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                        "+t._s(e.productname)+"\n                      ")])})],2)])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Discount Type")]),a("div",{staticClass:"form-input__input"},[a("Select2",{attrs:{options:t.options},model:{value:e.discounttype,callback:function(a){t.$set(e,"discounttype",a)},expression:"input.discounttype"}})],1)])]),"Volume Discount"==e.discounttype?a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Minimum order Amount")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.minorder,expression:"input.minorder"}],attrs:{type:"number",required:""},domProps:{value:e.minorder},on:{input:function(a){a.target.composing||t.$set(e,"minorder",a.target.value)}}})])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v(" Maximum Order Amount")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.maxorder,expression:"input.maxorder"}],attrs:{type:"number",required:""},domProps:{value:e.maxorder},on:{input:function(a){a.target.composing||t.$set(e,"maxorder",a.target.value)}}})])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Discount Amount (NGN)")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.discountedamount,expression:"input.discountedamount"}],attrs:{type:"text",required:""},domProps:{value:e.discountedamount},on:{input:function(a){a.target.composing||t.$set(e,"discountedamount",a.target.value)}}})])])]):t._e(),"Percent"==e.discounttype?a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Discount In % ")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.discountedpercent,expression:"input.discountedpercent"}],attrs:{type:"range",min:"1",max:"100",required:""},domProps:{value:e.discountedpercent},on:{__r:function(a){return t.$set(e,"discountedpercent",a.target.value)}}}),a("div",{staticClass:"form-input__input"},[t._v("Percentage in Value: "+t._s(e.discountedpercent))])])])]):t._e(),a("div",{staticClass:"flex-width-1-2 less-gp"},[a("button",{directives:[{name:"show",rawName:"v-show",value:s==t.discountdata.discountfee.length-1,expression:"i == discountdata.discountfee.length-1"}],staticClass:"btn btn--primary",staticStyle:{float:"left"},attrs:{type:"button"},on:{click:function(e){return t.addNew(s)}}},[t._v(" Add\n              ")]),a("button",{directives:[{name:"show",rawName:"v-show",value:s||!s&&t.discountdata.discountfee.length>1,expression:"i || ( !i && discountdata.discountfee.length > 1)"}],staticClass:"btn btn--primary",staticStyle:{float:"left"},attrs:{type:"button"},on:{click:function(e){return t.remove(s)}}},[t._v("Remove")])])])}),a("div",{staticClass:"d-flx-alc-jfe mt-5"},[a("button",{staticClass:"btn btn-no-fill",attrs:{type:"button",id:"cancelBtn"},on:{click:t.closeModal}},[t._v("\n              Cancel\n            ")]),a("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"submitBtn",type:"submit"}},[t._v("\n              + Create Discount\n            ")])])],2)])]),a("div",{attrs:{id:"edit-tax","uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeEdit}}),a("div",{staticClass:"modal-header"},[a("h2",[t._v("Edit Discount")]),a("p",[t._v("Enter the details to update a new tax.")])]),a("form",{on:{submit:function(e){return e.preventDefault(),t.updateDiscount.apply(null,arguments)}}},[a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Product")]),a("div",{staticClass:"form-input__input"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.editData.productID,expression:"editData.productID"}],staticClass:"filter-btn box-deco-smallr",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.editData,"productID",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("-Select Product-")]),t._l(t.products,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                      "+t._s(e.productname)+"\n                    ")])})],2)])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Discount Type")]),a("div",{staticClass:"form-input__input"},[a("Select2",{attrs:{options:t.options},model:{value:t.editData.discounttype,callback:function(e){t.$set(t.editData,"discounttype",e)},expression:"editData.discounttype"}})],1)])]),"Volume Discount"==t.editData.discounttype?a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Min Volume")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.minorder,expression:"editData.minorder"}],attrs:{type:"text"},domProps:{value:t.editData.minorder},on:{input:function(e){e.target.composing||t.$set(t.editData,"minorder",e.target.value)}}})]),t.errorData.minorder?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter the min discount")]):t._e()]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Max Volume")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.maxorder,expression:"editData.maxorder"}],attrs:{type:"text"},domProps:{value:t.editData.maxorder},on:{input:function(e){e.target.composing||t.$set(t.editData,"maxorder",e.target.value)}}})]),t.errorData.maxorder?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a max discount")]):t._e()]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Discount Volume")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.discountedvalue,expression:"editData.discountedvalue"}],attrs:{id:"edit_value_tax",type:"text"},domProps:{value:t.editData.discountedvalue},on:{input:function(e){e.target.composing||t.$set(t.editData,"discountedvalue",e.target.value)}}})]),t.errorData.discountedamount?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a discount value")]):t._e()])]):t._e(),"Percent"==t.editData.discounttype?a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Discount In % ")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.discountedpercent,expression:"editData.discountedpercent"}],attrs:{type:"range",min:"1",max:"100",required:""},domProps:{value:t.editData.discountedpercent},on:{__r:function(e){return t.$set(t.editData,"discountedpercent",e.target.value)}}}),a("div",{staticClass:"form-input__input"},[t._v("Percentage in Value: "+t._s(t.editData.discountedpercent))])])])]):t._e(),a("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"updateBtn",type:"submit"}},[t._v("\n                Edit\n              ")])])])])],1)};s._withStripped=!0;var i={render:s,staticRenderFns:[]};e.a=i},Giur:function(t,e,a){var s=a("xAlX");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("9421ec5a",s,!1,{sourceMap:!1})},"I+EI":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("b6zg"),i=a("BGUl"),n=!1;var o=function(t){n||a("Giur")},r=a("VU/8")(s.a,i.a,!1,o,"data-v-2b86e8f2",null);r.options.__file="pages/settings/discount/index.vue",e.default=r.exports},b6zg:function(t,e,a){"use strict";(function(t){var s=a("bOdI"),i=a.n(s);e.a={layout:"main",data:function(){return{loading:!0,formData:{merchID:""},discountdata:{merchID:"",discountfee:[{minorder:"",maxorder:"",discountedamount:0,productID:"",discounttype:"",discountedpercent:0}]},tax_classifications:[],discount:[],products:[],deleteData:{},options:[{id:"Percent",text:"Percent"},{id:"Volume Discount",text:"Volume Discount"}],errorData:{productID:!1,maxorder:!1,minorder:!1,discountedamount:!1},editData:{id:"",minorder:"",maxorder:"",discountedamount:"",discountedpercent:"",discounttype:"",productID:""}}},computed:{isCourierService:function(){return this.user.businessdescription.toLowerCase().includes("delivery")}},methods:{addNew:function(){var t,e=(t={minorder:"",maxorder:""},i()(t,"minorder",""),i()(t,"maxorder",""),i()(t,"discountedamount",0),i()(t,"productID",""),i()(t,"discounttype",""),i()(t,"discountedpercent",0),t);this.discountdata.discountfee.push(e),this.discountdata.merchID=this.newID},remove:function(t){this.discountdata.discountfee.splice(t,1)},doDelete:function(){var t=this;this.$store.dispatch("discount/deleteDiscount",this.deleteData).then(function(e){if(e.data.status)return t.$toast.success(e.data.message),t.formData.merchID=t.user.id,t.cancelDelete(),void t.getDiscount();t.formData.merchID=t.user.id,t.$toast.error("An error occurred")}).catch(function(e){t.formData.merchID=t.user.id,console.log(e),t.$toast.error("An error occurred")})},cancelDelete:function(){this.deleteData={id:""},t("#delete-text").removeClass("uk-open").hide()},listProduct:function(){var t=this;this.$store.dispatch("discount/listProducts",this.formData).then(function(e){t.products=e.data.data})},createDiscount:function(){var e=this;this.discountdata=this.discountdata.discountfee;var a={merchID:this.user.id,discountfee:this.discountdata};t("#submitBtn").attr("disabled",!0).html("Saving....please wait"),this.$store.dispatch("discount/saveDiscount",a).then(function(a){if(t("#submitBtn").attr("disabled",!1).html("+ Create Discount"),a.data.status)return e.$toast.success(a.data.message),e.getDiscount(),e.closeModal(),void location.reload();e.$toast.error(a.data.message)}).catch(function(t){console.log(t)})},deleteDiscount:function(e){this.deleteData=e,t("#delete-text").addClass("uk-open").show()},updateDiscount:function(){var e=this;this.editData,t("#updateBtn").attr("disabled",!0).html("Updating..please wait"),this.$store.dispatch("discount/updateDiscount",this.editData).then(function(a){if(t("#updateBtn").attr("disabled",!1).html("+ Update"),a.data.status)return e.$toast.success(a.data.message),e.getDiscount(),void e.closeEdit();e.editData.merchID=e.user.id,e.$toast.error(a.data.message)}).catch(function(a){e.editData.merchID=e.user.id,t("#updateBtn").attr("disabled",!1).html("+ Update"),console.log(a)})},getDiscount:function(){var t=this;this.$store.dispatch("discount/listDiscount",this.formData).then(function(e){t.loading=!1,t.discount=e.data.data}).catch(function(e){t.loading=!1,console.log(e)})},editDiscount:function(t){this.editData=t,UIkit.modal("#edit-tax").toggle()},openModal:function(){UIkit.modal("#add-tax").toggle()},closeModal:function(){UIkit.modal("#add-tax").toggle("hide")},clearErrorData:function(){this.errorData={tax:!1}},closeEdit:function(){this.editData={},this.formData.merchID=this.user.id,UIkit.modal("#edit-tax").toggle("hide")},formatPrice:function(t){var e=t.toString().split(".");return e[0].length>=3&&(e[0]=e[0].replace(/(\d)(?=(\d{3})+$)/g,"$1,")),e[1]||(e[1]="00"),e.join(".")}},beforeRouteEnter:function(t,e,a){var s=JSON.parse(localStorage.getItem("user"));void 0==s.role||s.rolepermission&&s.rolepermission[0].discounts.viewdiscount?a():(alert("You have not been permitted to view this page"),a({path:"/dashboard"}))},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.getDiscount(),this.listProduct()}}}).call(e,a("7t+N"))},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var s=function(t){return t&&t.__esModule?t:{default:t}}(a("C4MV"));e.default=function(t,e,a){return e in t?(0,s.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},xAlX:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".btn--primary[data-v-2b86e8f2]{background-color:#089628;color:#fff;min-width:10px!important}.btn--danger[data-v-2b86e8f2]{background-color:#dc3545;color:#fff;min-width:10px!important;left:5px;position:relative}.btn[data-v-2b86e8f2]{padding:9.6px 19.2px;padding:.6rem 1.2rem}",""])}});