webpackJsonp([12],{"4YY/":function(t,e,r){"use strict";(function(t){var a=r("Gu7T"),i=r.n(a),n=r("ZBej");e.a={layout:"main",components:{ReturnNotes:n.a},data:function(){return{formData:{merchID:"",description:"",vendorID:"",branchID:"",orderdate:"",duedate:"",purchaseID:"",notedetails:[]},errorData:{purchaseID:!1,orderdate:!1},poitems:[],vendors:[],branches:[],products:[],purchaseorder:"",purchaseOrders:[]}},computed:{recievedate:{set:function(t){this.$refs.returnote.setDate(t),this.formData.orderdate=t,console.log("hey")},get:function(){return this.formData.orderdate}}},methods:{validate:function(){if(""==this.formData.purchaseID)return this.errorData.purchaseID=!0,!0;if(""==this.formData.orderdate)return this.errorData.orderdate=!0,!0;var t=this.formData.notedetails.filter(function(t){return""==t.receivedate});return console.log(t),t.length>0?(this.$toast.error("Recieve Date for products "+t.map(function(t){return t.vendorproductcode}).reduce(function(t,e){return t+=", "+e})+" are empty"),!0):void 0},saveGoodsReturn:function(){var e=this;this.formData.notedetails=this.poitems,this.validate()||(t("#submitBtn").attr("disabled",!0).html("Saving....."),this.$store.dispatch("purchaseorders/saveGoodsReturnNote",this.formData).then(function(r){if(t("#submitBtn").attr("disabled",!1).html("+ Save Goods Return Note"),r.data.status)return e.$toast.success(r.data.message),e.$router.push("/inventory/purchase-order"),void(e.errorData={purchaseID:!1,orderdate:!1});e.$toast.error("An error occurred")}).catch(function(e){t("#submitBtn").attr("disabled",!1).html("+ Save Goods Return Note")}))},cancelOrderReturn:function(){this.$router.push("/inventory/purchase-order")},getTotalQty:function(t){if(void 0!=t)return t.map(function(t){return t.quantity}).reduce(function(t,e){return t+=Number(e)},0)},setGoodsReturnNote:function(){var e=this,r=JSON.parse(localStorage.getItem("po_data")),a=JSON.parse(localStorage.getItem("goodsReturn"));r&&function(){e.formData.purchaseID=r.id,e.formData.branchID=r.branchID,e.formData.vendorID=r.vendorID,e.formData.description=r.description,e.formData.duedate=e.$moment(r.duedate).format("YYYY-MM-DD");var n=r.receiveorderitems;e.purchaseorder=r.purchaseordercode;var o=a.goodsreturnnoteitems;if(o.length>0)for(var s=function(t){var a=e.getTotalQty(n.map(function(e){return e.receivenoteitems.filter(function(e){return e.productID==o[t].productID})}).reduce(function(t,e){return t.push.apply(t,i()(e)),t},[]));e.poitems.push({productID:o[t].productID,quantity:o[t].quantity,vendorproductcode:o[t].vendorproductcode,quantityreceived:a,quantityleft:a-o[t].quantity,unitprice:o[t].unitprice,totalprice:o[t].totalprice,branchID:r.branchID,receivedate:o[t].receivedate,merchID:o[t].merchID})},c=0;c<o.length;c++)s(c);t(" input").prop("disabled",!0),t("select").prop("disabled",!0),t("textarea").prop("disabled",!0),t("#footer").hide(),t(".section-title").html("Goods Return Note For Purchase Order : "+r.purchaseordercode)}()},addChild:function(){this.poitems.push({productID:"",quantity:"",vendorproductcode:"",unitprice:0,totalprice:0,branchID:"",receivedate:"",merchID:""})},removeChild:function(t){this.poitems.splice(t,1)},getBranches:function(){var t=this;this.$store.dispatch("branches/listBranches",this.formData.merchID).then(function(e){t.branches=e.data.data}).catch(function(t){console.log(t)})},getVendors:function(){var t=this;this.$store.dispatch("vendor/listVendors",this.formData.merchID).then(function(e){t.vendors=e.data.data}).catch(function(t){console.log(t)})},getProducts:function(){var t=this;this.$store.dispatch("products/listProducts",this.formData.merchID).then(function(e){t.products=e.data.data}).catch(function(t){console.log(t)})},setMerchID:function(t){this.poitems[t].merchID=this.formData.merchID},listPurchaseOrders:function(){var t=this;this.$store.dispatch("purchaseorders/listPurchaseOrder",this.formData.merchID).then(function(e){if(e.data.status)return t.purchaseOrders=e.data.data,void(t.loading=!1);t.$toast.error("An error occurred while retrieving records")}).catch(function(e){t.loading=!1,t.$toast.error("An error occurred while retrieving records")})},setPurchaseOrder:function(t){this.poitems=[];var e=this.purchaseOrders.find(function(e){return e.purchaseordercode==t.target.value});if(console.log(this.purchaseOrders),e){this.formData.purchaseID=e.id,this.formData.branchID=e.branchID,this.formData.vendorID=e.vendorID,this.formData.description=e.description,this.formData.duedate=this.$moment(e.duedate).format("YYYY-MM-DD");var r=e.purchaseorderitems;if(console.log(r),r.length>0)for(var a=0;a<r.length;a++)this.poitems.push({productID:r[a].productID,quantity:r[a].quantity,quantityreceived:r[a].quantity,quantityleft:0,vendorproductcode:r[a].vendorproductcode,unitprice:r[a].unitprice,totalprice:r[a].totalprice,total:r[a].totalprice,branchID:e.branchID,receivedate:"",merchID:r[a].merchID});else this.addChild(),this.removeChild(1)}}},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.getProducts(),this.getBranches(),this.getVendors(),this.listPurchaseOrders(),this.setGoodsReturnNote()}}}).call(e,r("7t+N"))},CLxh:function(t,e,r){(t.exports=r("FZ+f")(!1)).push([t.i,".v-btn:not(.v-btn--round).v-size--default[data-v-d2733e34]{background-color:green!important}th[data-v-d2733e34]{font-size:10px!important}",""])},LO7R:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("4YY/"),i=r("RdZp"),n=r("VU/8")(a.a,i.a,!1,null,null,null);n.options.__file="pages/inventory/purchase-order/order-return/index.vue",e.default=n.exports},RSGT:function(t,e,r){"use strict";var a=r("3EgV"),i=r.n(a);e.a={layout:"main",vuetify:new i.a,props:["poitems","type"],data:function(){return{snack:!1,snackColor:"green",snackText:"",pagination:{},headers:[{text:"Product",align:"end",sortable:!1,value:"productID"},{text:"Code",value:"vendorproductcode",align:"end",sortable:!1},{text:"Qty. Recieved",value:"quantityreceived",align:"end",sortable:!1},{text:"Qty. Returned",value:"quantity",align:"start",sortable:!1},{text:"Left Over",value:"quantityleft",align:"end",sortable:!1},{text:"Return Date",value:"recievedate",align:"start",sortable:!1},{text:"Total Price",value:"totalprice",align:"end",sortable:!1},{text:"Cost / Piece",value:"unitprice",align:"end",sortable:!1},{text:"Actions",value:"actions",sortable:!1}],products:[]}},computed:{loading:function(){return!(this.poitems.length>0)},totalitems:function(){var t=this.poitems.map(function(t){return t.totalprice}).reduce(function(t,e){return t+=e},0);return console.log(t),t},totalprice:function(){var t=this.poitems.map(function(t){return t.total}).reduce(function(t,e){return t+=e},0);return console.log(t),t}},methods:{deleteItem:function(t){this.poitems.splice(this.poitems.indexOf(t),1)},calcDiscount:function(t){return(t.quantityordered*t.unitprice-Number(this.totalprice))/t.quantity},calcQty:function(t){t.quantity=t.packsize*t.packquantity,1==t.quantity&&0!=t.unitprice&&(0!=t.packcost?t.quantity=t.packcost*t.packsize/t.unitprice:t.quantity=(t.totalprice+this.calcDiscount(t))/t.unitprice)},calcPackQty:function(t){t.packquantity=t.quantity/t.packsize,1==t.packquantity&&0!=t.packcost&&(t.packquantity=(t.totalprice+this.calcDiscount(t))/t.packcost)},calcPackCost:function(t){t.packcost=t.packsize*t.unitprice*t.packquantity,0==t.packcost&&(t.packcost=(t.totalprice+this.calcDiscount(t))/t.unitprice)},calcUnitPrice:function(t){t.unitprice=(t.totalprice+this.calcDiscount(t))/t.quantity},calculateTotal:function(t,e){switch(console.log(t),t.packsize=void 0!=t.packsize&&""!=t.packsize?Number(t.packsize):1,t.packquantity=void 0!=t.packquantity&&""!=t.packquantity?Number(t.packquantity):1,t.packcost=void 0!=t.packcost&&""!=t.packcost?Number(t.packcost):0,t.quantity=void 0!=t.quantity&&""!=t.quantity?Number(t.quantity):1,t.unitprice=void 0!=t.unitprice&&""!=t.unitprice?Number(t.unitprice):0,t.discountprice=void 0!=t.discountprice&&""!=t.discountprice?Number(t.discountprice):0,e){case"packsize":this.calcPackQty(t),this.calcQty(t);break;case"packquantity":this.calcQty(t);break;case"quantity":this.calcPackQty(t)}t.quantityleft=t.quantityreceived-t.quantity,t.totalprice=t.quantity*t.unitprice-this.calcDiscount(t)},getProductName:function(t){console.log(t);var e=this.products.find(function(e){return t.productID==e.id});return void 0!=e?(t.vendorproductcode=e.productcode,t.productcode=e.productcode,e.productname):"Select a Product"},save:function(t,e){"name"!=e&&this.calculateTotal(t,e),this.snack=!0,this.snackColor="success",this.snackText="Data saved"},cancel:function(){this.snack=!0,this.snackColor="error",this.snackText="Canceled"},open:function(){this.snack=!0,this.snackColor="info",this.snackText="Dialog opened"},close:function(){console.log("Dialog closed")},addChild:function(){this.poitems.unshift({id:"",productID:"",packsize:"",packquantity:"",packcost:"",quantity:"",quantityrecieved:"",quantityleft:"",vendorproductcode:"",unitprice:0,discountprice:0,totalprice:0,merchID:this.user.id})},removeChild:function(t){this.poitems.splice(t,1)},getProducts:function(){var t=this;this.$store.dispatch("products/listProducts",this.user.id).then(function(e){t.products=e.data.data}).catch(function(t){console.log(t)})},setDate:function(t){console.log(t),this.poitems.map(function(e){return""!=e.receivedate&&void 0!=e.receivedate||(e.receivedate=t),e})}},mounted:function(){console.log(this.poitems),this.getProducts()}}},RdZp:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main-content-wrap"},[r("div",{staticClass:"d-flx-alc-jsb page-extras"},[r("p",{staticClass:"fw-medium font-16"},[r("nuxt-link",{staticClass:"text-link",attrs:{to:"/inventory/purchase-order"}},[r("svg",[r("use",{attrs:{href:"/uploads/icons.svg#back"}})]),r("span",{staticClass:"ml-1 fw-bold co-grey"},[t._v("Back")])])],1),r("div",{staticClass:"search-filter d-flx-alc-jfe"})]),r("div",{staticClass:"inner-main-wrapper"},[t._m(0),r("overlay-scrollbars",{staticClass:"table-wrapper no-deco"},[r("div",{staticClass:"mt-2"},[r("div",{staticClass:"flex-width-1-1 less-gp"},[r("label",{staticClass:"form-input"},[r("span",{staticClass:"form-input__label"},[t._v("Purchase Order")]),r("div",{staticClass:"form-input__input"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.purchaseorder,expression:"purchaseorder"}],staticClass:"filter-btn box-deco-smallr",on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.purchaseorder=e.target.multiple?r:r[0]},t.setPurchaseOrder]}},[r("option",{attrs:{value:""}},[t._v("-Select Purchase Order-")]),t._l(t.purchaseOrders,function(e){return r("option",{key:e.id,domProps:{value:e.purchaseordercode}},[t._v("\n                    "+t._s(e.purchaseordercode)+"\n                  ")])})],2)]),t.errorData.purchaseID?r("span",{staticClass:"form-input__error-msg"},[t._v("Please select a purchase order")]):t._e()])]),r("div",{staticClass:"flex-width-1-2 less-gp"},[r("label",{staticClass:"form-input"},[r("span",{staticClass:"form-input__label"},[t._v("Branch")]),r("div",{staticClass:"form-input__input"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.branchID,expression:"formData.branchID"}],staticClass:"filter-btn box-deco-smallr",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"branchID",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:""}},[t._v("-Select Branch-")]),t._l(t.branches,function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.branchname)+"\n                  ")])})],2)])]),r("label",{staticClass:"form-input"},[r("span",{staticClass:"form-input__label"},[t._v("Vendor")]),r("div",{staticClass:"form-input__input"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.vendorID,expression:"formData.vendorID"}],staticClass:"filter-btn box-deco-smallr",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"vendorID",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:""}},[t._v("-Select Vendor-")]),t._l(t.vendors,function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.vendorname)+"\n                  ")])})],2)])])]),r("div",{staticClass:"flex-width-1-2 less-gp"},[r("label",{staticClass:"form-input"},[r("span",{staticClass:"form-input__label"},[t._v("Return date")]),r("div",{staticClass:"form-input__input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.recievedate,expression:"recievedate"}],attrs:{type:"date",name:""},domProps:{value:t.recievedate},on:{input:function(e){e.target.composing||(t.recievedate=e.target.value)}}})]),t.errorData.orderdate?r("span",{staticClass:"form-input__error-msg"},[t._v("Please select a Return Date")]):t._e()]),r("label",{staticClass:"form-input"},[r("span",{staticClass:"form-input__label"},[t._v("Due date")]),r("div",{staticClass:"form-input__input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.duedate,expression:"formData.duedate"}],attrs:{type:"date",name:""},domProps:{value:t.formData.duedate},on:{input:function(e){e.target.composing||t.$set(t.formData,"duedate",e.target.value)}}})])])]),r("ReturnNotes",{ref:"returnote",attrs:{poitems:t.poitems,type:"returnNotes"}}),r("div",{staticClass:"d-flx-alc-jfe mt-3",attrs:{id:"footer"}},[r("button",{staticClass:"btn btn-no-fill",attrs:{type:"button"},on:{click:t.cancelOrderReturn}},[t._v("\n              Cancel\n            ")]),r("button",{staticClass:"btn btn--primary ml-1",attrs:{type:"submit",id:"submitBtn"},on:{click:t.saveGoodsReturn}},[t._v("\n              + Save Goods Return Note\n            ")])])],1)])],1)])};a._withStripped=!0;var i={render:a,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flx-alc-jsb table-title"},[e("h3",{staticClass:"section-title"},[this._v("Save Goods Return note")])])}]};e.a=i},VNoS:function(t,e,r){var a=r("CLxh");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("rjj0")("0d3638ff",a,!1,{sourceMap:!1})},Z9P3:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-responsive",[r("v-data-table",{attrs:{headers:t.headers,"no-data-text":"No items in the list",items:t.poitems,loading:t.loading,"footer-props":{itemsPerPage:"200"}},scopedSlots:t._u([{key:"top",fn:function(){return[r("v-toolbar",{staticClass:"text-right",attrs:{flat:""}},[r("v-toolbar-title",[t._v("Order Items")]),r("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),r("v-spacer")],1)]},proxy:!0},{key:"header.name",fn:function(e){var r=e.header;return[t._v("\n\t\t\t"+t._s(r.text.toUpperCase())+"\n\t\t\t")]}},{key:"item.productID",fn:function(e){return[t._v("\n                "+t._s(t.getProductName(e.item))+"\n\t\t\t\t")]}},{key:"item.quantity",fn:function(e){return[r("v-edit-dialog",{on:{save:function(r){return t.save(e.item,"quantity")},cancel:t.cancel,open:t.open,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[r("v-text-field",{attrs:{type:"number",label:"Edit Qty","single-line":"",max:e.item.quantityreceived,autofocus:""},on:{keyup:function(r){return t.save(e.item,"quantity")}},model:{value:e.item.quantity,callback:function(r){t.$set(e.item,"quantity",r)},expression:"props.item.quantity"}})]},proxy:!0}],null,!0)},[r("div",[t._v(t._s(t.formNumber(e.item.quantity)))])])]}},{key:"item.recievedate",fn:function(e){return[r("v-edit-dialog",{on:{cancel:t.cancel,open:t.open,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[r("v-text-field",{attrs:{type:"date",label:"Edit Receive Note","single-line":"",autofocus:""},model:{value:e.item.receivedate,callback:function(r){t.$set(e.item,"receivedate",r)},expression:"props.item.receivedate"}})]},proxy:!0}],null,!0)},[r("div",[t._v(t._s(""!=e.item.receivedate?t.$moment(e.item.receivedate).format("YYYY-MM-DD"):""))])])]}},{key:"item.totalprice",fn:function(e){return[r("div",[t._v(t._s(t.formatPrice(e.item.totalprice)))])]}},{key:"item.quantityreceived",fn:function(e){return[r("div",[t._v(t._s(t.formNumber(e.item.quantityreceived)))])]}},{key:"item.quantityleft",fn:function(e){return[r("div",[t._v(t._s(t.formNumber(e.item.quantityleft)))])]}},{key:"footer",fn:function(){return[r("v-col",{staticClass:"text-right smaller",attrs:{cols:"12"}},[t._v("\n\t\t\t\tTotal Return Value : "+t._s(t.totalitems)+"\n\n\t\t\t\t\n\t\t\t\t")]),r("v-col",{staticClass:"text-right smaller",attrs:{cols:"12"}},[t._v("\n\t\t\t\tTotal Price : "+t._s(t.totalprice)+"\n\t\t\t\t")])]},proxy:!0},{key:"item.actions",fn:function(e){var a=e.item;return[r("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(a)}}},[t._v("\n\t\t\t\t\tmdi-delete\n\t\t\t\t")])]}}])})],1)],1)};a._withStripped=!0;var i={render:a,staticRenderFns:[]};e.a=i},ZBej:function(t,e,r){"use strict";var a=r("RSGT"),i=r("Z9P3"),n=!1;var o=function(t){n||r("VNoS")},s=r("VU/8")(a.a,i.a,!1,o,"data-v-d2733e34",null);s.options.__file="components/ReturnNotes.vue",e.a=s.exports}});