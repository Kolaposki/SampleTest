webpackJsonp([50],{"HX/F":function(e,t,s){(e.exports=s("FZ+f")(!1)).push([e.i,"input.checkbox[data-v-0ca91b30]{height:20px;width:20px}h1[data-v-0ca91b30]{font-size:2em;font-weight:600}.btn--primary[data-v-0ca91b30]{background-color:#089628;color:#fff;min-width:10px!important}.btn--danger[data-v-0ca91b30]{background-color:#dc3545;color:#fff;min-width:10px!important;left:5px;position:relative}.btn[data-v-0ca91b30]{padding:9.6px 19.2px;padding:.6rem 1.2rem}.tab[data-v-0ca91b30]{overflow:hidden;border:.5px solid #eee;background-color:#fff;padding-left:2em}.tab button[data-v-0ca91b30]{background-color:inherit;float:left;border:1px solid #228b22;outline:none;cursor:pointer;padding:18px 32px;font-weight:600;margin-left:1em}.tab button[data-v-0ca91b30]:hover{background-color:#f8f8f8;color:#228b22;font-weight:600}.tab button.active[data-v-0ca91b30]{color:#fff;background-color:#228b22}",""])},IWts:function(e,t,s){"use strict";(function(e){t.a={layout:"main",data:function(){return{loading:!0,customer:"",customers:[],deliveryTime:{now:!0,scheduled:!1},pickupGeoCode:{formatted_address:"",latitude:"",longitude:""},showDeliveryForm:!0,showFoodForm:!1,tabs:["Delivery","Food"],selectedTab:"Delivery",deliveryGeoCode:[],formData:{merchID:""},getData:{id:"",page:1},courierOptionValue:"",courierSenderValue:"",sendersName:"",sendersNumber:"",sendersAddress:"",itemName:"",itemQty:"",source:"",orderCategoryValue:"",orderCategory:[{id:"Delivery",text:"Delivery"},{id:"Food",text:"Food"}],packageCategoryValue:"",delivery:[{receiversName:"",receiversNumber:"",address:"",landmark:"",deliveryNote:""}],payMethod:"",courierOptions:[{id:"pool",text:"Pool"},{id:"express",text:"Express"}],courierSender:[{id:"sender",text:"Send a package"},{id:"receiver",text:"Receive a package"},{id:"third-party",text:"Third Party"}],packageCategory:[{id:"gadgets",text:"Gadgets"},{id:"food",text:"Food"},{id:"health",text:"Health"},{id:"products",text:"Products"},{id:"documents",text:"Documents"},{id:"others",text:"Others"}],paymentMethodValue:"",paymentMethod:[{id:"card",text:"Card"},{id:"cash",text:"Cash"},{id:"banktransfer",text:"Bank Transfer"}],sources:[{id:"cooperatesales",text:"Cooperate Sales"},{id:"callandwhatsapp",text:"Call and Whatsapp"},{id:"socialmedia",text:"Social Media"}],scheduleValue:"now",scheduletime:"",branches:[],branch:"",errorData:{phoneNumber:!1,sendersAddress:!0,deliveryAddress:!0}}},computed:{isCourierService:function(){return this.user.businessdescription.toLowerCase().includes("delivery")}},methods:{getCustomers:function(){var e=this;this.$store.dispatch("customer/getCustomersAll",this.getData).then(function(t){t.data.status&&e.setCustomers(t.data.data)})},setCustomers:function(e){var t=this;this.customers.push({id:0,text:"Select a customer"}),e.forEach(function(e){var s={id:e.id,text:e.firstname+" "+e.lastname};t.customers.push(s)})},setTab:function(e){this.selectedTab=e,"Delivery"==e?(this.showFoodForm=!1,this.showDeliveryForm=!0):(this.showFoodForm=!0,this.showDeliveryForm=!1)},toggleDeliveryTime:function(){this.deliveryTime.scheduled=!this.deliveryTime.scheduled,this.deliveryTime.now=!this.deliveryTime.now,this.deliveryTime.scheduled?this.scheduleValue="scheduletime":this.scheduleValue="now"},getCoordinates:function(e,t,s){var a=window.google,i=new a.maps.places.PlacesService(document.getElementById("map"));if(""!=e){var r={query:e,fields:["name","geometry","formatted_address"]},o=this;try{i.findPlaceFromQuery(r,function(e,i){return i===a.maps.places.PlacesServiceStatus.OK?("sender"==t&&e[0].geometry.location.lng()&&e[0].geometry.location.lat()&&(o.pickupGeoCode.longitude=e[0].geometry.location.lng(),o.pickupGeoCode.latitude=e[0].geometry.location.lat(),o.pickupGeoCode.formatted_address=e[0].formatted_address,o.$toast.success("Address coordinates found")),void("delivery"==t&&(o.deliveryGeoCode[s]={formatted_address:e[0].formatted_address,latitude:e[0].geometry.location.lat(),longitude:e[0].geometry.location.lng()},o.$toast.success("Address coordinates found")))):void o.$toast.error("Address cordinates not found. Please enter an address with street name, city and state")})}catch(e){console.log(e)}}},validatePhonenumber:function(e){/^\d{11}$/.test(e)?this.errorData.phoneNumber=!1:(this.$toast.error("Invalid phone number entered. It must be 11-digits"),this.errorData.phoneNumber=!0)},addNew:function(){this.delivery.push({receiversName:"",receiversNumber:"",address:"",landmark:"",deliveryNote:""})},remove:function(e){this.delivery.splice(e,1)},placeorder:function(){var t,s=this;e("#placeOrderBtn").attr("disabled",!0).html("Submitting..please wait");var a=[];if(this.deliveryGeoCode.forEach(function(e){e.latitude&&e.longitude&&(s.errorData.deliveryAddress=!1)}),this.pickupGeoCode.latitude&&this.pickupGeoCode.longitude?this.errorData.sendersAddress=!1:this.errorData.sendersAddress=!0,""==this.scheduletime&&(this.scheduletime="now"),this.errorData.phoneNumber||this.errorData.deliveryAddress||this.errorData.sendersAddress)this.$toast.error("Error found in detail(s) provided. Cross-check and try again"),e("#placeOrderBtn").attr("disabled",!1).html("Submit");else{for(var i=0;i<this.delivery.length;i++)a.push({area:"none",city:"none",deliveryaddress:this.deliveryGeoCode[i].formatted_address,deliverylatitude:this.deliveryGeoCode[i].latitude,deliverylongitude:this.deliveryGeoCode[i].longitude,landmark:this.delivery[i].landmark,receivername:this.delivery[i].receiversName,deliveryinstruction:this.delivery[i].deliveryNote,receiverphonenumber:this.delivery[i].receiversNumber,state:"none"});t={ordercode:"",ordertotal:0,merchID:this.formData.merchID,branchID:Number(this.branch),riderID:"",deliverycharge:0,ETA:"",orderstatus:"pending",paymentstatus:"cash"==this.paymentMethodValue?"PENDING":"PAID",ordertype:"",ordermethod:this.courierOptionValue,ordercategory:"Delivery",pickupaddress:this.pickupGeoCode.formatted_address,sendername:this.sendersName,senderphone:this.sendersNumber,pickuplongitude:this.pickupGeoCode.longitude,pickuplatitude:this.pickupGeoCode.latitude,paymentreference:"",paymentaccountname:"",paymentaccountnumber:"",deliveryinstruction:"",itemname:this.itemName,itemquantity:this.itemQty,weight:"100",discountpayment:"0.00",vechicletype:"bike",staffID:this.formData.merchID,deliverylocation:a,itemcategory:this.packageCategoryValue,paymentmethod:this.paymentMethodValue,source:this.source,customerID:0==this.customer?"":this.customer,scheduletime:this.scheduletime},this.$store.dispatch("order/placeOrder",t).then(function(t){t.status?(e("#placeOrderBtn").attr("disabled",!1).html("Submit"),s.$toast.success("Submitted successfully"),document.getElementById("goBackToOrders").click()):(e("#placeOrderBtn").attr("disabled",!1).html("Submit"),s.$toast.error("An error occurred "+t.message))}).catch(function(e){s.$toast.error("An error occurred "+e)})}},listBranches:function(){var e=this;this.$store.dispatch("branches/listBranches",this.formData.merchID).then(function(t){t.data.data.forEach(function(t){e.branches.push({id:t.id,text:t.branchname})})}).catch(function(e){console.log(e)})}},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.getData.id=this.user.role?this.user.merchID:this.user.id,this.listBranches(),this.getCustomers()},beforeRouteEnter:function(e,t,s){var a=JSON.parse(localStorage.getItem("user"));void 0==a.role||a.rolepermission&&a.rolepermission[0].orders.placeorder?s():(alert("You have not been permitted to view this page"),s({path:"/dashboard"}))}}}).call(t,s("7t+N"))},Ih7E:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("IWts"),i=s("jwnD"),r=!1;var o=function(e){r||s("e6/9")},l=s("VU/8")(a.a,i.a,!1,o,"data-v-0ca91b30",null);l.options.__file="pages/order/index.vue",t.default=l.exports},"e6/9":function(e,t,s){var a=s("HX/F");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);s("rjj0")("69e78f70",a,!1,{sourceMap:!1})},jwnD:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("overlay-scrollbars",{staticClass:"main-content-wrap"},[s("div",{staticClass:"tab d-flx-alc"},[s("nuxt-link",{staticClass:"text-link",staticStyle:{"margin-right":"10px"},attrs:{to:"/orders/"}},[s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#back"}})]),s("span",{staticClass:"ml-1 fw-bold co-grey"},[e._v("Back")])]),s("div",e._l(e.tabs,function(t,a){return s("button",{key:a,class:e.selectedTab==t?"active":"",on:{click:function(s){return e.setTab(t)}}},[e._v(e._s(t))])}),0)],1),e.showDeliveryForm?s("div",{staticClass:"inner-main-wrapper",attrs:{id:"delivery-form"}},[s("div",{staticClass:"box-deco-bg p-3"},[s("section",{staticClass:"setting-section"},[s("form",{staticClass:"mt-2 ml-2",on:{submit:function(t){return t.preventDefault(),e.placeorder.apply(null,arguments)}}},[s("h2",{staticStyle:{"font-size":"24px","font-weight":"600","margin-bottom":"20px"}},[e._v("Order Information")]),s("hr"),s("div",[s("div",{staticClass:"flex-width-1-2 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Delivery Type")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{placeholder:"Select delivery type",required:!0,options:e.courierOptions},model:{value:e.courierOptionValue,callback:function(t){e.courierOptionValue=t},expression:"courierOptionValue"}})],1)]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Order Source")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{required:!0,placeholder:"Select order source",options:e.sources},model:{value:e.source,callback:function(t){e.source=t},expression:"source"}})],1)])]),s("div",{staticClass:"flex-width-1-2 less-gp mb-3"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Branch")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{required:!0,placeholder:"Select a branch",options:e.branches},model:{value:e.branch,callback:function(t){e.branch=t},expression:"branch"}})],1)]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Payment Method")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{placeholder:"Select payment method",required:!0,options:e.paymentMethod},model:{value:e.paymentMethodValue,callback:function(t){e.paymentMethodValue=t},expression:"paymentMethodValue"}})],1)])]),s("div",{staticClass:"flex-width-1-2 less-gp mb-3"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Customer(optional)")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{placeholder:"Select a customer",options:e.customers},model:{value:e.customer,callback:function(t){e.customer=t},expression:"customer"}})],1)])]),s("h2",{staticStyle:{"font-size":"24px","font-weight":"600","margin-bottom":"20px"}},[e._v("Pick-up Information")]),s("hr"),s("div",{staticClass:"flex-width-1-2 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Sender's Name")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendersName,expression:"sendersName"}],attrs:{type:"text",required:""},domProps:{value:e.sendersName},on:{input:function(t){t.target.composing||(e.sendersName=t.target.value)}}})])]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Sender's Phone Number "),s("span",{staticStyle:{color:"red","font-size":"12px"}},[e._v("(must be 11-digits e.g: 08080000000)")])]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendersNumber,expression:"sendersNumber"}],attrs:{type:"tel",required:""},domProps:{value:e.sendersNumber},on:{blur:function(t){return e.validatePhonenumber(e.sendersNumber)},input:function(t){t.target.composing||(e.sendersNumber=t.target.value)}}})])])]),s("div",{staticClass:"flex-width-1-1 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v(" Pick-Up Address")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendersAddress,expression:"sendersAddress"}],attrs:{id:"map",type:"text",required:""},domProps:{value:e.sendersAddress},on:{change:function(t){return e.getCoordinates(e.sendersAddress,"sender")},input:function(t){t.target.composing||(e.sendersAddress=t.target.value)}}})])])]),s("div",{staticClass:"flex-width-1-2 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Item Name")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.itemName,expression:"itemName"}],attrs:{type:"text",required:""},domProps:{value:e.itemName},on:{input:function(t){t.target.composing||(e.itemName=t.target.value)}}})])]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Item Quantity")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.itemQty,expression:"itemQty"}],attrs:{type:"number",min:"0",required:""},domProps:{value:e.itemQty},on:{input:function(t){t.target.composing||(e.itemQty=t.target.value)}}})])])]),s("div",{staticClass:"flex-width-1-2 less-gp mb-3"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Package Category")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{placeholder:"Select package category",required:!0,options:e.packageCategory},model:{value:e.packageCategoryValue,callback:function(t){e.packageCategoryValue=t},expression:"packageCategoryValue"}})],1)]),s("label",{staticClass:"form-input"})]),s("h2",{staticStyle:{"font-size":"24px","font-weight":"600","margin-bottom":"20px"}},[e._v("Delivery Information")]),s("hr"),e._l(e.delivery,function(t,a){return s("div",{key:a},[s("div",{staticClass:"flex-width-1-2 less-gp mt-1"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Receiver's Name")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.receiversName,expression:"input.receiversName"}],attrs:{type:"text",required:""},domProps:{value:t.receiversName},on:{input:function(s){s.target.composing||e.$set(t,"receiversName",s.target.value)}}})])]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Receiver's Phone Number "),s("span",{staticStyle:{color:"red","font-size":"12px"}},[e._v("(must be 11-digits e.g: 08080000000)")])]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.receiversNumber,expression:"input.receiversNumber"}],attrs:{type:"tel",required:""},domProps:{value:t.receiversNumber},on:{blur:function(s){return e.validatePhonenumber(t.receiversNumber)},input:function(s){s.target.composing||e.$set(t,"receiversNumber",s.target.value)}}})])])]),s("div",{staticClass:"flex-width-1-1 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v(" Delivery Address")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.address,expression:"input.address"}],attrs:{type:"text",required:""},domProps:{value:t.address},on:{change:function(s){return e.getCoordinates(t.address,"delivery",a)},input:function(s){s.target.composing||e.$set(t,"address",s.target.value)}}})])])]),s("div",{staticClass:"flex-width-1-2 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Landmark (Optional)")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.landmark,expression:"input.landmark"}],attrs:{type:"text"},domProps:{value:t.landmark},on:{input:function(s){s.target.composing||e.$set(t,"landmark",s.target.value)}}})])]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Delivery Note (Optional)")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.deliveryNote,expression:"input.deliveryNote"}],attrs:{type:"text"},domProps:{value:t.deliveryNote},on:{input:function(s){s.target.composing||e.$set(t,"deliveryNote",s.target.value)}}})])])]),s("div",{staticClass:"d-flx-alc"},[s("button",{directives:[{name:"show",rawName:"v-show",value:a==e.delivery.length-1,expression:"i == delivery.length-1"}],staticClass:"btn btn--primary mr-1",attrs:{type:"button"},on:{click:function(t){return e.addNew()}}},[e._v("\n              Add another delivery location\n              ")]),s("button",{directives:[{name:"show",rawName:"v-show",value:a||!a&&e.delivery.length>1,expression:"i || ( !i && delivery.length > 1)"}],staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:function(t){return e.remove(a)}}},[e._v(" remove")])])])}),s("hr",{staticClass:"mt-3"}),s("div",{staticClass:"flex-width-1-2 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Delivery Time")]),s("label",{staticClass:"form-input"},[s("label",{staticStyle:{display:"flex"}},[s("div",{staticClass:"form-input",staticStyle:{display:"flex"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.deliveryTime.now,expression:"deliveryTime.now"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.deliveryTime.now)?e._i(e.deliveryTime.now,null)>-1:e.deliveryTime.now},on:{click:e.toggleDeliveryTime,change:function(t){var s=e.deliveryTime.now,a=t.target,i=!!a.checked;if(Array.isArray(s)){var r=e._i(s,null);a.checked?r<0&&e.$set(e.deliveryTime,"now",s.concat([null])):r>-1&&e.$set(e.deliveryTime,"now",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.deliveryTime,"now",i)}}}),s("p",{staticClass:"form_input__label ml-1 mr-2",staticStyle:{"font-size":"16px","margin-top":"-5px"}},[e._v("Now")])]),s("div",{staticClass:"form-input",staticStyle:{display:"flex"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.deliveryTime.scheduled,expression:"deliveryTime.scheduled"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.deliveryTime.scheduled)?e._i(e.deliveryTime.scheduled,null)>-1:e.deliveryTime.scheduled},on:{click:e.toggleDeliveryTime,change:function(t){var s=e.deliveryTime.scheduled,a=t.target,i=!!a.checked;if(Array.isArray(s)){var r=e._i(s,null);a.checked?r<0&&e.$set(e.deliveryTime,"scheduled",s.concat([null])):r>-1&&e.$set(e.deliveryTime,"scheduled",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.deliveryTime,"scheduled",i)}}}),s("p",{staticClass:"form_input__label ml-1",staticStyle:{"font-size":"16px: margin-top: -5px"}},[e._v("Scheduled")])])])])]),s("label",{directives:[{name:"show",rawName:"v-show",value:"scheduletime"==e.scheduleValue,expression:"scheduleValue == 'scheduletime'"}],staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Select Date")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.scheduletime,expression:"scheduletime"}],attrs:{type:"datetime-local"},domProps:{value:e.scheduletime},on:{input:function(t){t.target.composing||(e.scheduletime=t.target.value)}}})])])]),s("div",{staticClass:"d-flx-alc-jfe mt-5"},[s("nuxt-link",{staticClass:"btn btn-no-fill",attrs:{to:"/orders/"}},[e._v("Cancel")]),s("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"placeOrderBtn",type:"submit"}},[e._v("\n              Submit\n            ")])],1)],2)])]),s("nuxt-link",{staticClass:"btn btn--primary",attrs:{id:"goBackToOrders",to:"/orders/",hidden:""}},[e._v("Back")])],1)]):e._e(),e.showFoodForm?s("div",{staticClass:"inner-main-wrapper",attrs:{id:"food-form"}},[s("div",{staticClass:"box-deco-bg p-3"},[s("section",{staticClass:"setting-section"},[s("form",{staticClass:"mt-2 ml-2",on:{submit:function(t){return t.preventDefault(),e.placeorder.apply(null,arguments)}}},[s("div",[s("div",{staticClass:"flex-width-1-2 less-gp"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Delivery Type")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{required:!0,options:e.courierOptions},model:{value:e.courierOptionValue,callback:function(t){e.courierOptionValue=t},expression:"courierOptionValue"}})],1)]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[e._v("Order Source")]),s("div",{staticClass:"form-input__input"},[s("Select2",{attrs:{required:!0,options:e.sources},model:{value:e.source,callback:function(t){e.source=t},expression:"source"}})],1)])]),s("div",{staticClass:"d-flx-alc-jfe mt-5"},[s("nuxt-link",{staticClass:"btn btn-no-fill",attrs:{to:"/orders/"}},[e._v("Cancel")]),s("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"placeOrderBtn",type:"submit"}},[e._v("\n              Submit\n            ")])],1)])])]),s("nuxt-link",{staticClass:"btn btn--primary",attrs:{id:"goBackToOrders",to:"/orders/",hidden:""}},[e._v("Back")])],1)]):e._e()])};a._withStripped=!0;var i={render:a,staticRenderFns:[]};t.a=i}});