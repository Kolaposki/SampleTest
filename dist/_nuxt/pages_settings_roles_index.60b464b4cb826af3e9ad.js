webpackJsonp([42],{"+7QJ":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("O8y5"),o=s("Ue8y"),r=!1;var i=function(e){r||s("JNc/")},n=s("VU/8")(a.a,o.a,!1,i,"data-v-70779de6",null);n.options.__file="pages/settings/roles/index.vue",t.default=n.exports},"6FX3":function(e,t,s){(e.exports=s("FZ+f")(!1)).push([e.i,".btn--primary[data-v-70779de6]{background-color:#089628;color:#fff;min-width:30px!important}.btn--danger[data-v-70779de6]{background-color:#dc3545;color:#fff;min-width:30px!important;left:5px;position:relative}.btn[data-v-70779de6]{padding:9.6px 19.2px;padding:.6rem 1.2rem}",""])},"JNc/":function(e,t,s){var a=s("6FX3");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);s("rjj0")("adbde4e2",a,!1,{sourceMap:!1})},O8y5:function(e,t,s){"use strict";(function(e){t.a={layout:"main",data:function(){return{loading:!0,formData:{merchID:"",userid:"",id:""},roles:[],roleUsers:[],id:null,name:""}},computed:{},methods:{getRoles:function(){var e=this;this.$store.dispatch("role/getPermissions",this.formData).then(function(t){e.loading=!1,e.roles=t.data.data,localStorage.removeItem("roles"),e.$store.dispatch("role/setAllRole",e.roles)}).catch(function(t){e.loading=!1,console.log(t)})},viewPermissions:function(e){localStorage.removeItem("role"),this.$store.dispatch("role/setRole",e),this.$router.push("/settings/roles/view-role/"+e.id)},doDelete:function(){var e=this,t={id:this.id};this.$store.dispatch("role/deleteRole",t).then(function(t){if(t.data.status)return e.$toast.success("Role deleted successfully!"),e.formData.merchID=e.user.role?e.user.merchID:e.user.id,e.getRoles(),void e.cancelDelete();e.formData.merchID=e.user.role?e.user.merchID:e.user.id,e.$toast.error("An error occurred")}).catch(function(t){e.formData.merchID=e.user.role?e.user.merchID:e.user.id,console.log(t),e.$toast.error("An error occurred")})},deleteRole:function(t,s){this.id=t,this.name=s,e("#delete-modal").addClass("uk-open").show()},cancelDelete:function(){this.id=null,this.name="",e("#delete-modal").removeClass("uk-open").hide()},openUsersModal:function(t){var s;s=this.roles.filter(function(e){return e.id==t}),this.roleUsers=s[0].userecord,e("#users-modal").addClass("uk-open").show()},closeUsersModal:function(){this.id=null,e("#users-modal").removeClass("uk-open").hide()}},beforeRouteEnter:function(e,t,s){var a=JSON.parse(localStorage.getItem("user"));void 0==a.role||a.rolepermission&&a.rolepermission[0].settings.viewroles?s():(alert("You have not been permitted to view this page"),s({path:"/dashboard"}))},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.formData.userid="",this.formData.id="",this.getRoles()}}}).call(t,s("7t+N"))},Ue8y:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("overlay-scrollbars",{staticClass:"main-content-wrap"},[s("overlay-scrollbars",{staticClass:"page-extras d-flx-alc-jsb settings-extra"},[s("div",{staticClass:"links-wrap"},[s("nuxt-link",{attrs:{to:"/settings"}},[e._v("Business Rules")]),e.user.rolepermission&&e.user.rolepermission[0].tax.viewtax||e.isMerchant?s("nuxt-link",{attrs:{to:"/settings/tax"}},[e._v("Tax")]):e._e(),e.user.rolepermission&&e.user.rolepermission[0].discounts.viewdiscount||e.isMerchant?s("nuxt-link",{attrs:{to:"/settings/discount"}},[e._v("Discount")]):e._e(),e.user.rolepermission&&e.user.rolepermission[0].settings.viewroles||e.isMerchant?s("nuxt-link",{staticClass:"active",attrs:{to:"/settings/roles"}},[e._v("Roles & Permissions")]):e._e(),e.user.rolepermission&&e.user.rolepermission[0].settings.viewlease||e.isMerchant?s("nuxt-link",{attrs:{to:"/settings/lease"}},[e._v("Lease")]):e._e()],1)]),s("div",{attrs:{id:"parent-component"}},[s("div",{attrs:{id:"delete-modal","uk-modal":"",container:"#parent-component","data-uk-modal":"{target:'#delete-modal',bgclose:false}"}},[s("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical small-modal"},[s("button",{staticClass:"uk-modal-close-default",attrs:{"uk-close":"",type:"button"},on:{click:e.cancelDelete}}),s("div",{staticClass:"modal-header d-flx"},[s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#co-delete"}})]),s("div",{staticClass:"ml-1"},[s("h2",[e._v("Delete Role?")]),s("p",[e._v("Please confirm you like to delete the "),s("strong",[e._v(e._s(this.name.toUpperCase()))]),e._v(" role.")])])]),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"d-flx-alc-jc mt-3"},[s("button",{staticClass:"btn btn-no-fill",on:{click:e.cancelDelete}},[e._v("\n                Cancel\n              ")]),s("button",{staticClass:"btn btn-error ml-2",on:{click:e.doDelete}},[e._v("\n                Delete\n              ")])])])])])]),s("div",{attrs:{id:"parent-component"}},[s("div",{attrs:{id:"users-modal","uk-modal":"",container:"#parent-component","data-uk-modal":"{target:'#users-modal',bgclose:false}"}},[s("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[s("div",{staticClass:" d-flx-alc-jsb"},[s("h2",{staticStyle:{"font-weight":"600"}},[e._v("Assigned Users")]),s("button",{staticClass:"uk-modal-close-default mt-2 mr-2",attrs:{"uk-close":"",type:"button"},on:{click:e.closeUsersModal}})]),s("overlay-scrollbars",{staticClass:"table-wrapper"},[s("table",{staticClass:"table-content"},[s("thead",{},[s("tr",[s("th",{staticClass:"column-name"},[e._v("Name")]),s("th",{staticClass:"column-name"},[e._v("Email")])])]),s("tbody",{staticClass:"table-content large-content"},[e.roleUsers.length<1?s("tr",[s("td",{attrs:{colspan:"3"}},[e._v("No Users assigned at the moment.")])]):e._e(),e._l(e.roleUsers,function(t,a){return e.roles.length>0?s("tr",{key:a},[s("td",{staticClass:"column-name"},[e._v(e._s(t.firstname)+" "+e._s(t.lastname))]),s("td",{staticClass:"column-name"},[e._v(e._s(t.emailaddress))])]):e._e()})],2)])])],1)])]),s("div",{staticClass:"inner-main-wrapper"},[s("div",{staticClass:"py-3 px-0"},[s("section",{staticClass:"setting-section"},[s("div",{staticClass:"setting-section-title d-flx-alc-jsb"},[s("h2",[e._v("Roles and Permission")]),e.user.rolepermission&&e.user.rolepermission[0].settings.addrole||e.isMerchant?s("div",{staticClass:"btn btn--primary",on:{click:function(t){return e.$router.push("/settings/roles/add")}}},[e._v("Create Role")]):e._e()]),s("overlay-scrollbars",{staticClass:"table-wrapper"},[s("table",{staticClass:"table-content"},[s("thead",{},[s("tr",[s("th",{staticClass:" column-name",staticStyle:{width:"20%"}},[e._v("Role Name")]),s("th",[e._v("Assigned Users")]),s("th",{},[e._v("Action")])])]),s("tbody",{staticClass:"table-content large-content"},[e.loading?s("tr",[s("td",{attrs:{colspan:"3"}},[e._v("Loading...please wait")])]):e._e(),!e.loading&&e.roles.length<1?s("tr",[s("td",{attrs:{colspan:"3"}},[e._v("No Role set at the moment.")])]):e._e(),e._l(e.roles,function(t,a){return!e.loading&&e.roles.length>0?s("tr",{key:a,staticClass:"link"},[s("td",{staticClass:"column-name",on:{click:function(s){return e.openUsersModal(t.id)}}},[e._v(e._s(t.rolename))]),s("td",{on:{click:function(s){return e.openUsersModal(t.id)}}},[e._v(e._s(t.customercount))]),s("td",{staticClass:"d-flx-alc"},[e.user.rolepermission&&e.user.rolepermission[0].settings.viewpermission||e.isMerchant?s("button",{staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:function(s){return e.viewPermissions(t)}}},[e._v("\n                        Edit\n                      ")]):e._e(),e.user.rolepermission&&e.user.rolepermission[0].settings.deleterole||e.isMerchant?s("button",{staticClass:"btn btn--danger",attrs:{type:"button"},on:{click:function(s){return e.deleteRole(t.id,t.rolename)}}},[e._v("\n                        Delete\n                      ")]):e._e()])]):e._e()})],2)])])],1)])])],1)};a._withStripped=!0;var o={render:a,staticRenderFns:[]};t.a=o}});