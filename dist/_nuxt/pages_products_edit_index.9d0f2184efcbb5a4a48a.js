webpackJsonp([8],{"39JQ":function(t,e,a){"use strict";var r=a("Xxa5"),o=a.n(r),s=a("exGp"),i=a.n(s);e.a={name:"imageCrop",props:["pic","update"],data:function(){return{vanilla:null,image:"",link:"none"}},computed:{file:{set:function(t){this.link=t},get:function(){return"none"!=this.link?this.link:this.update}}},mounted:function(){},methods:{onFileChange:function(t){var e=t.target.files||t.dataTransfer.files;e.length&&(["image/png","image/jpg","image/jpeg"].includes(e[0].type)?e.length&&this.createImage(e[0]):this.$toast.error("Only Images of Type jpg, jpeg and png allowed"))},removeImage:function(t){this.image="",this.file="",this.vanilla&&this.vanilla.destroy()},createImage:function(t){var e=this,a=(new Image,new FileReader),r=document.querySelector("#"+this.pic);this.vanilla=new Croppie(r,{viewport:{width:400,height:400},boundary:{width:500,height:500},showZoomer:!0}),a.onload=function(t){e.image=t.target.result,e.vanilla.bind({url:t.target.result})},a.readAsDataURL(t)},getImage:function(){var t=i()(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this,null==this.vanilla){t.next=4;break}return t.next=4,this.vanilla.result("blob").then(function(t){e.image=t,e.$emit("image",t)});case 4:return t.abrupt("return",this.image);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}}},"4Ovz":function(t,e,a){"use strict";var r=a("39JQ"),o=a("X1X0"),s=!1;var i=function(t){s||a("96g7")},n=a("VU/8")(r.a,o.a,!1,i,"data-v-33db1a60",null);n.options.__file="components/imageCrop.vue",e.a=n.exports},"5EAX":function(t,e,a){"use strict";(function(t){var r=a("Xxa5"),o=a.n(r),s=a("mvHQ"),i=a.n(s),n=a("exGp"),c=a.n(n),p=a("s8OY"),l=a("4Ovz");e.a={components:{ImageCrop:l.a,AddProductFeature:p.a},layout:"main",data:function(){return{formData:{merchID:"",productcode:"",productname:"",productdescription:"",stockqty:"",sellingprice:"",expirationdate:"",producttype:"",productfeatures:[{price:"",featureID:""}],restocklevel:0,branchID:"",categoryID:"",id:""},nonstockedForm:!1,stockedForm:!1,serviceForm:!1,productTypes:[{id:"nonstocked_product",text:"Non-stocked product"},{id:"stocked_product",text:"Stocked product"},{id:"service",text:"Service"}],branches:[],categories:[],productDescription:"",errorData:{productcode:!1,productname:!1,productdescription:!1,stockqty:!1,sellingprice:!1,expirationdate:!1,producttype:!1,branchID:!1,restocklevel:!1,categoryID:!1,photo1:!1,photo2:!1,photo3:!1,photo4:!1},photo1:"",photo2:"",photo3:"",photo4:""}},methods:{saveEditProduct:function(){var e=c()(o.a.mark(function e(){var a,r,s=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.clearValidation(),""==this.$refs.features.productFeatures[0].featureID?this.formData.sellingprice=this.$refs.features.productFeatures[0].price:this.formData.sellingprice=0,!this.validateFormData()){e.next=4;break}return e.abrupt("return");case 4:return a=null==this.formData.expirationdate||""==this.formData.expirationdate?"":this.formData.expirationdate,r=new FormData,""==this.formData.restocklevel&&(this.formData.restocklevel=0),r.append("merchID",this.formData.merchID),r.append("productcode",this.formData.productcode),r.append("productname",this.formData.productname),r.append("productdescription",this.formData.productdescription),r.append("stockqty",this.formData.stockqty),r.append("sellingprice",this.formData.sellingprice),r.append("expiration_date",a),r.append("producttype",this.formData.producttype),r.append("branchID",this.formData.branchID),r.append("categoryID",this.formData.categoryID),r.append("restocklevel",this.formData.restocklevel),this.$refs.features.productFeatures.length>1?(""==this.$refs.features.productFeatures[0].featureID&&this.$refs.features.productFeatures.splice(0,1),r.append("productfeatures",i()(this.$refs.features.productFeatures))):r.append("productfeatures",i()([])),e.next=21,this.$refs.photo1.getImage();case 21:return e.next=23,this.$refs.photo3.getImage();case 23:return e.next=25,this.$refs.photo4.getImage();case 25:return e.next=27,this.$refs.photo2.getImage();case 27:(this.photo1.length>0||""!=this.photo1)&&(r.append("photo",this.photo1,"file1."+this.photo1.type.split("/")[1]),this.formData.photo=this.photo1),(this.photo2.length>0||""!=this.photo2)&&(r.append("photo2",this.photo2,"file2."+this.photo2.type.split("/")[1]),this.formData.photo2=this.photo2),(this.photo3.length>0||""!=this.photo3)&&(r.append("photo3",this.photo3,"file3."+this.photo3.type.split("/")[1]),this.formData.photo3=this.photo3),(this.photo4.length>0||""!=this.photo4)&&(r.append("photo4",this.photo4,"file4."+this.photo4.type.split("/")[1]),this.formData.photo4=this.photo4),r.append("id",this.formData.id),t("#submitBtn").attr("disabled",!0).html("Updating..please wait"),this.$store.dispatch("products/editProduct",r).then(function(e){if(t("#submitBtn").attr("disabled",!1).html("+ Update product"),e.data.status)return s.$toast.success("Product was successfully updated"),s.clearForm(),void s.$router.push("/products");s.$toast.error("An error occurred.")}).catch(function(e){s.$toast.error("An error occurred."),console.log(e),t("#submitBtn").attr("disabled",!1).html("+ Update product")});case 34:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),clearValidation:function(){this.errorData={productcode:!1,productname:!1,productdescription:!1,stockqty:!1,sellingprice:!1,expirationdate:!1,producttype:!1,branchID:!1,restocklevel:!1,categoryID:!1,photo1:!1,photo2:!1,photo3:!1,photo4:!1}},validateFormData:function(){return""===this.formData.producttype?(this.errorData.producttype=!0,!0):""===this.formData.categoryID?(this.errorData.categoryID=!0,!0):""===this.formData.productname?(this.errorData.productname=!0,!0):""===this.formData.stockqty?(this.errorData.stockqty=!0,!0):"stocked_product"!==this.formData.producttype||""!=this.formData.restocklevel&&0!=this.formData.restocklevel?""===this.formData.sellingprice?(this.errorData.sellingprice=!0,!0):""===this.formData.branchID?(this.errorData.branchID=!0,!0):(""===this.formData.productdescription||void 0===this.formData.productdescription)&&(this.errorData.productdescription=!0,!0):(this.errorData.restocklevel=!0,!0)},clearForm:function(){this.formData={productcode:"",productname:"",productdescription:"",stockqty:"",sellingprice:"",expirationdate:"",producttype:"",productfeatures:[{featureID:"",price:""}],restocklevel:0,branchID:"",categoryID:"",id:""}},cancelForm:function(){this.clearForm(),this.$router.push("/products")},listBranches:function(){var t=this;this.$store.dispatch("branches/listBranches",this.formData.merchID).then(function(e){var a=[];e.data.data.forEach(function(t){var e={id:t.id,text:t.branchname};a.push(e)}),t.branches=a})},listProductCategory:function(){var t=this;this.$store.dispatch("category/getCategories",this.formData.merchID).then(function(e){var a=[];e.data.data.forEach(function(t){var e={id:t.id,text:t.categoryname};a.push(e)}),t.categories=a})},attachedProducts:function(){this.clearForm();var t=JSON.parse(localStorage.getItem("product_data"));(t.productfeatureinfo.length<=0||Number(t.sellingprice)>0)&&t.productfeatureinfo.unshift({price:t.sellingprice,featureID:""}),this.formData={merchID:t.merchID,productcode:null!=t.productcode&&"null"!=t.productcode?t.productcode:"",productname:t.productname,productdescription:t.productdescription,stockqty:t.stockqty,sellingprice:t.sellingprice,expirationdate:t.expiration_date,producttype:t.producttype,branchID:t.branchID,restocklevel:null!=t.restocklevel?t.restocklevel:0,productfeatures:t.productfeatureinfo,categoryID:t.categoryID,id:t.id,photo:t.photo,photo2:t.photo2,photo3:t.photo3,photo4:t.photo4}}},created:function(){this.attachedProducts()},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.listBranches(),this.listProductCategory()}}}).call(e,a("7t+N"))},"96g7":function(t,e,a){var r=a("kdQO");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("cbe58688",r,!1,{sourceMap:!1})},"9cgY":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("overlay-scrollbars",{staticClass:"main-content-wrap"},[a("div",{staticClass:"d-flx-alc-jsb page-extras"},[a("p",{staticClass:"fw-medium font-16"},[a("nuxt-link",{staticClass:"text-link",attrs:{to:"/products"}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#back"}})]),a("span",{staticClass:"ml-1 fw-bold co-grey"},[t._v("Back")])])],1),a("div",{staticClass:"search-filter d-flx-alc-jfe"})]),a("div",{staticClass:"inner-main-wrapper"},[a("div",{staticClass:"d-flx-alc-jsb table-title"},[a("h3",{staticClass:"section-title"},[t._v("Edit Product")])]),a("overlay-scrollbars",{staticClass:"table-wrapper no-deco"},[a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Select Type")]),a("div",{staticClass:"form-input__input"},[a("Select2",{attrs:{options:t.productTypes},model:{value:t.formData.producttype,callback:function(e){t.$set(t.formData,"producttype",e)},expression:"formData.producttype"}})],1),t.errorData.producttype?a("span",{staticClass:"form-input__error-msg"},[t._v("Please select a product type")]):t._e()]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Select Category")]),a("div",{staticClass:"form-input__input"},[a("Select2",{attrs:{options:t.categories},model:{value:t.formData.categoryID,callback:function(e){t.$set(t.formData,"categoryID",e)},expression:"formData.categoryID"}})],1),t.errorData.categoryID?a("span",{staticClass:"form-input__error-msg"},[t._v("Please select a category")]):t._e()])]),a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("SKU (Product code)")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.productcode,expression:"formData.productcode"}],attrs:{type:"text",placeholder:""},domProps:{value:t.formData.productcode},on:{input:function(e){e.target.composing||t.$set(t.formData,"productcode",e.target.value)}}})]),t.errorData.productcode?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a product code")]):t._e()]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Name")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.productname,expression:"formData.productname"}],attrs:{type:"text",placeholder:""},domProps:{value:t.formData.productname},on:{input:function(e){e.target.composing||t.$set(t.formData,"productname",e.target.value)}}})]),t.errorData.productname?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a product name")]):t._e()])]),a("div",{class:"stocked_product"==t.formData.producttype?"flex-width-1-2 less-gp":"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Stock/ Quantity")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.stockqty,expression:"formData.stockqty"}],attrs:{type:"text",placeholder:""},domProps:{value:t.formData.stockqty},on:{input:function(e){e.target.composing||t.$set(t.formData,"stockqty",e.target.value)}}})]),t.errorData.stockqty?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a stock")]):t._e()]),"stocked_product"==t.formData.producttype?a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Re-order Level"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.restocklevel,expression:"formData.restocklevel"}],attrs:{type:"text",placeholder:""},domProps:{value:t.formData.restocklevel},on:{input:function(e){e.target.composing||t.$set(t.formData,"restocklevel",e.target.value)}}})]),t.errorData.restocklevel?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a re order stock")]):t._e()]):t._e()]),a("add-product-feature",{ref:"features",attrs:{featuresList:t.formData.productfeatures}}),t.isSupervisor?t._e():a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Branch")]),a("div",{staticClass:"form-input__input"},[a("Select2",{attrs:{options:t.branches},model:{value:t.formData.branchID,callback:function(e){t.$set(t.formData,"branchID",e)},expression:"formData.branchID"}})],1),t.errorData.branchID?a("span",{staticClass:"form-input__error-msg"},[t._v("Please select a branch")]):t._e()]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Expiry Date")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.expirationdate,expression:"formData.expirationdate"}],attrs:{type:"date",placeholder:""},domProps:{value:t.formData.expirationdate},on:{input:function(e){e.target.composing||t.$set(t.formData,"expirationdate",e.target.value)}}})]),t.errorData.expirationdate?a("span",{staticClass:"form-input__error-msg"},[t._v("Please select an expiration date")]):t._e()])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Description")]),a("div",{staticClass:"form-input__input"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.productdescription,expression:"formData.productdescription"}],attrs:{rows:"5"},domProps:{value:t.formData.productdescription},on:{input:function(e){e.target.composing||t.$set(t.formData,"productdescription",e.target.value)}}})]),t.errorData.productdescription?a("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a product description")]):t._e()]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Photo 1 "),a("span",{staticStyle:{"font-size":"smaller"}},[t._v("(400px * 400px)")])]),a("image-crop",{ref:"photo1",attrs:{update:t.formData.photo,pic:"photo1"},on:{image:function(e){t.photo1=e}}}),t.errorData.photo1?a("span",{staticClass:"form-input__error-msg"},[t._v("Photo 1 size must be 400px * 400px")]):t._e()],1)]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Photo 2 "),a("span",{staticStyle:{"font-size":"smaller"}},[t._v("(400px * 400px)")])]),a("image-crop",{ref:"photo2",attrs:{update:t.formData.photo2,pic:"photo2"},on:{image:function(e){t.photo2=e}}}),t.errorData.photo2?a("span",{staticClass:"form-input__error-msg"},[t._v("Photo 2 size must be 400px * 400px")]):t._e()],1)]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Photo 3 "),a("span",{staticStyle:{"font-size":"smaller"}},[t._v("(400px * 400px)")])]),a("image-crop",{ref:"photo3",attrs:{update:t.formData.photo3,pic:"photo3"},on:{image:function(e){t.photo3=e}}}),t.errorData.photo3?a("span",{staticClass:"form-input__error-msg"},[t._v("Photo 3 size must be 400px * 400px")]):t._e()],1)]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Photo 4 "),a("span",{staticStyle:{"font-size":"smaller"}},[t._v("(400px * 400px)")])]),a("image-crop",{ref:"photo4",attrs:{update:t.formData.photo4,pic:"photo4"},on:{image:function(e){t.photo4=e}}}),t.errorData.photo4?a("span",{staticClass:"form-input__error-msg"},[t._v("Photo 4 size must be 400px * 400px")]):t._e()],1)]),a("div",{staticClass:"d-flx-alc-jfe mt-3"},[a("button",{staticClass:"btn btn-no-fill",attrs:{type:"button"},on:{click:t.cancelForm}},[t._v("\n              Cancel\n            ")]),a("button",{staticClass:"btn btn--primary ml-1",attrs:{type:"submit",id:"submitBtn"},on:{click:t.saveEditProduct}},[t._v("\n              + Update product\n            ")])])],1)],1)])};r._withStripped=!0;var o={render:r,staticRenderFns:[]};e.a=o},UclR:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._l(t.productFeatures,function(e,r){return a("div",{key:r,staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Select Special Feature")]),a("div",{staticClass:"form-input__input"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.featureID,expression:"input.featureID"}],staticClass:"filter-btn box-deco-smallr",on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(e,"featureID",a.target.multiple?r:r[0])}}},[0==r?a("option",{attrs:{value:""}},[t._v("None")]):t._e(),t._l(t.features,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.featurename)+"\n                  ")])})],2)])]),a("label",{staticClass:"form-input"},[t._m(0,!0),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"input.price"}],attrs:{type:"number",required:""},domProps:{value:e.price},on:{input:function(a){a.target.composing||t.$set(e,"price",a.target.value)}}})])]),a("label",{directives:[{name:"show",rawName:"v-show",value:r==t.productFeatures.length-1,expression:"k == productFeatures.length-1"}],staticClass:"form-input"},[a("button",{staticClass:"btn btn-icon",attrs:{type:"button"},on:{click:function(e){return t.addChild(r)}}},[t._v("\n        Add More\n        ")])]),a("label",{directives:[{name:"show",rawName:"v-show",value:r||!r&&t.productFeatures.length>1,expression:"k || ( !k && productFeatures.length > 1)"}],staticClass:"form-input"},[a("button",{staticClass:"btn btn-icon",attrs:{type:"button"},on:{click:function(e){return t.removeChild(r)}}},[t._v("\n        Remove Above Feature\n        ")])])])}),0)};r._withStripped=!0;var o={render:r,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"form-input__label"},[this._v("Selling Price "),e("span",{staticStyle:{color:"red"}},[this._v("*")])])}]};e.a=o},X1X0:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"flex-width-1-1 less-gp"},["none"==t.file||void 0==t.file||""==t.file?a("img",{style:t.image?"margin: auto; ":"",attrs:{id:t.pic,src:t.image,alt:""}}):a("img",{staticStyle:{"margin-right":"auto","margin-left":"auto",width:"200px",height:"200px"},attrs:{id:t.pic,src:t.file,alt:""}})]),t.image||t.file?a("div",[a("button",{staticClass:"btn btn--primary",on:{click:t.removeImage}},[t._v("Change image")])]):a("div",[a("div",{staticClass:"form-input__input"},[a("input",{attrs:{id:"img_url",type:"file",accept:".png, .jpg, .jpeg"},on:{change:t.onFileChange}})])])])};r._withStripped=!0;var o={render:r,staticRenderFns:[]};e.a=o},hP7Y:function(t,e,a){"use strict";e.a={layout:"main",props:["featuresList"],data:function(){return{loading:!0,formData:{merchID:0},features:[],productFeatures:[{price:"",featureID:""}]}},methods:{listFeatures:function(){var t=this;this.$store.dispatch("products/listFeatures",this.formData.merchID).then(function(e){t.loading=!1,t.features=e.data.data}).catch(function(e){t.loading=!1})},addChild:function(){this.productFeatures.push({price:"",featureID:""})},removeChild:function(t){this.productFeatures.splice(t,1)}},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.listFeatures(),this.productFeatures=this.featuresList}}},kVtJ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("5EAX"),o=a("9cgY"),s=a("VU/8")(r.a,o.a,!1,null,null,null);s.options.__file="pages/products/edit/index.vue",e.default=s.exports},kdQO:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])},s8OY:function(t,e,a){"use strict";var r=a("hP7Y"),o=a("UclR"),s=a("VU/8")(r.a,o.a,!1,null,null,null);s.options.__file="components/AddProductFeature.vue",e.a=s.exports}});