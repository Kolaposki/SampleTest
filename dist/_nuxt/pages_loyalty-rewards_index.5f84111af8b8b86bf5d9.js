webpackJsonp([74],{OTDE:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("rSjf"),r=e("cpwb"),l=e("VU/8")(s.a,r.a,!1,null,null,null);l.options.__file="pages/loyalty-rewards/index.vue",a.default=l.exports},cpwb:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("overlay-scrollbars",{staticClass:"main-content-wrap"},[e("div",{staticClass:"d-flx-alc-jsb page-extras"},[e("p",{staticClass:"fw-medium font-16"}),e("div",{staticClass:"search-filter d-flx-alc-jfe"},[e("label",{staticClass:"search-w-icon"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:"Search"},domProps:{value:t.search},on:{input:function(a){a.target.composing||(t.search=a.target.value)}}}),e("svg",[e("use",{attrs:{href:"/uploads/icons.svg#search"}})])]),e("button",{staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:t.displayCreateModal}},[t._v("\n          + Create loyalty points\n        ")]),e("div",{staticClass:"drop-down page-drop"}),e("div",{staticClass:"d-flx-alc"})])]),e("div",{attrs:{id:"parent-component"}},[e("div",{attrs:{container:"#parent-component",id:"add-loyalty-rule","uk-modal":""}},[e("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[e("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeAddModal}}),e("div",{staticClass:"modal-header"},[e("h2",[t._v("Create Loyalty Points")]),e("p",[t._v("Create milestones your customers should reach and give them a reward for reaching the milestone. ")])]),e("form",{on:{submit:function(a){return a.preventDefault(),t.saveLoyaltyRule.apply(null,arguments)}}},[e("overlay-scrollbars",{staticClass:"modal-body",attrs:{"uk-overflow-auto":""}},[e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Loyalty")]),e("span",{staticClass:"font-14 co-lgray"},[t._v("Enter a name for the loyalty")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.loyaltyrule,expression:"formData.loyaltyrule"}],attrs:{type:"text",required:""},domProps:{value:t.formData.loyaltyrule},on:{input:function(a){a.target.composing||t.$set(t.formData,"loyaltyrule",a.target.value)}}})]),t.errorData.loyaltyrule?e("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a rule")]):t._e()])]),e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Reward point(s) for Every")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.rewardpoint,expression:"formData.rewardpoint"}],attrs:{type:"number",required:""},domProps:{value:t.formData.rewardpoint},on:{input:function(a){a.target.composing||t.$set(t.formData,"rewardpoint",a.target.value)}}})]),t.errorData.rewardpoint?e("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a reward point")]):t._e()]),e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Amount spent")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.amountspent,expression:"formData.amountspent"}],attrs:{type:"number",required:""},domProps:{value:t.formData.amountspent},on:{input:function(a){a.target.composing||t.$set(t.formData,"amountspent",a.target.value)}}})]),t.errorData.amountspent?e("span",{staticClass:"form-input__error-msg"},[t._v("Please enter an amount")]):t._e()])]),e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Start Date")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.startdate,expression:"formData.startdate"}],attrs:{type:"date",required:""},domProps:{value:t.formData.startdate},on:{input:function(a){a.target.composing||t.$set(t.formData,"startdate",a.target.value)}}})]),t.errorData.startdate?e("span",{staticClass:"form-input__error-msg"},[t._v("Please select a start date")]):t._e()]),e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("End Date")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.endate,expression:"formData.endate"}],attrs:{type:"date",required:""},domProps:{value:t.formData.endate},on:{input:function(a){a.target.composing||t.$set(t.formData,"endate",a.target.value)}}})]),t.errorData.endate?e("span",{staticClass:"form-input__error-msg"},[t._v("Please select an end date")]):t._e()])])]),e("div",{staticClass:"d-flx-alc-jfe mt-5"},[e("button",{staticClass:"btn btn-no-fill",attrs:{type:"button",id:"cancelBtn"},on:{click:t.closeAddModal}},[t._v("\n                Cancel\n              ")]),e("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"submitBtn",type:"submit"}},[t._v("\n                + Create loyalty points\n              ")])])],1)])]),e("div",{attrs:{container:"#parent-component",id:"edit-loyalty-rule","uk-modal":""}},[e("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[e("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeEditModal}}),e("div",{staticClass:"modal-header"},[e("h2",[t._v("Update Loyalty")]),e("p",[t._v("Update Loyalty Points details.")])]),e("form",{on:{submit:function(a){return a.preventDefault(),t.updateLoyaltyRule.apply(null,arguments)}}},[e("overlay-scrollbars",{staticClass:"modal-body",attrs:{"uk-overflow-auto":""}},[e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Loyalty")]),e("span",{staticClass:"font-14 co-lgray"},[t._v("Update Loyalty Name")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.loyaltyrule,expression:"editData.loyaltyrule"}],attrs:{type:"text",required:""},domProps:{value:t.editData.loyaltyrule},on:{input:function(a){a.target.composing||t.$set(t.editData,"loyaltyrule",a.target.value)}}})]),t.errorData.loyaltyrule?e("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a rule")]):t._e()])]),e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Reward point(s) for every ")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.rewardpoint,expression:"editData.rewardpoint"}],attrs:{type:"number",required:""},domProps:{value:t.editData.rewardpoint},on:{input:function(a){a.target.composing||t.$set(t.editData,"rewardpoint",a.target.value)}}})]),t.errorData.rewardpoint?e("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a reward point")]):t._e()]),e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Amount Spent")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.amountspent,expression:"editData.amountspent"}],attrs:{type:"number",required:""},domProps:{value:t.editData.amountspent},on:{input:function(a){a.target.composing||t.$set(t.editData,"amountspent",a.target.value)}}})]),t.errorData.amountspent?e("span",{staticClass:"form-input__error-msg"},[t._v("Please enter an amount")]):t._e()])]),e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Start Date")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.startdate,expression:"editData.startdate"}],attrs:{type:"date",required:""},domProps:{value:t.editData.startdate},on:{input:function(a){a.target.composing||t.$set(t.editData,"startdate",a.target.value)}}})]),t.errorData.startdate?e("span",{staticClass:"form-input__error-msg"},[t._v("Please select a start date")]):t._e()]),e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("End Date")]),e("div",{staticClass:"form-input__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editData.endate,expression:"editData.endate"}],attrs:{type:"date",required:""},domProps:{value:t.editData.endate},on:{input:function(a){a.target.composing||t.$set(t.editData,"endate",a.target.value)}}})]),t.errorData.endate?e("span",{staticClass:"form-input__error-msg"},[t._v("Please select an end date")]):t._e()])]),e("div",{staticClass:"flex-width-1-2 less-gp"},[e("label",{staticClass:"form-input"},[e("span",{staticClass:"form-input__label"},[t._v("Status")]),e("span",{staticClass:"font-14 co-lgray"},[t._v("Activate or Deactivate loyalty")]),e("div",{staticClass:"form-input__input"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.editData.status,expression:"editData.status"}],on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.editData,"status",a.target.multiple?e:e[0])}}},["True"==t.status?e("option",{attrs:{value:"True"}},[t._v("Reactivate")]):t._e(),t._l(t.options,function(a,s){return t.status!==a.id?e("option",{key:s,domProps:{value:a.id}},[t._v(t._s(a.text))]):t._e()})],2)])])])]),e("div",{staticClass:"d-flx-alc-jfe mt-5"},[e("button",{staticClass:"btn btn-no-fill",attrs:{type:"button"},on:{click:t.closeEditModal}},[t._v("\n                Cancel\n              ")]),e("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"updateBtn",type:"submit"}},[t._v("\n                + Update loyalty rule\n              ")])])],1)])])]),e("div",{staticClass:"inner-main-wrapper"},[t.loading?e("ul",[e("li",[e("div",{staticClass:"gifts-card"},[e("div",{staticClass:"gifts-card__extra"}),e("div",{staticClass:"gifts-card__title"},[t._v("\n              Loading...please wait\n            ")])])])]):t._e(),!t.loading&&t.filteredList.length<1?e("ul",[e("li",[e("div",{staticClass:"gifts-card"},[e("div",{staticClass:"gifts-card__extra"}),e("div",{staticClass:"gifts-card__title"},[t._v("\n              No loyalty point rule have been created\n            ")])])])]):t._e(),!t.loading&&t.filteredList.length>0?e("ul",{staticClass:"loyalty-list grid mostly-4-fill"},t._l(t.filteredList,function(a,s){return e("li",{key:s},[e("a",{staticClass:"loyalty-card",on:{click:function(e){return e.preventDefault(),t.editLoyalty(a)}}},[e("div",{staticClass:"loyalty-card__body"},[e("h3",[t._v("\n                "+t._s(a.loyaltyrule)+"\n              ")]),e("p",[t._v(t._s(t.formNumber(a.rewardpoint))+" points for every N"+t._s(t.formatPrice(a.amountspent))+" spent ")])]),e("div",{staticClass:"loyalty-card__foot"},[e("p",{staticClass:"d-flx-alc"},[t.checkDate(a.endate)?e("span",{staticClass:"status no-radius ended"},[t._v("Ended")]):0==a.status?e("span",{staticClass:"status no-radius ended"},[t._v("Inactive")]):e("span",{staticClass:"status no-radius active"},[t._v("Active")]),e("svg",[e("use",{attrs:{"xlink:href":"/uploads/icons.svg#trophy"}})])])])])])}),0):t._e()])])};s._withStripped=!0;var r={render:s,staticRenderFns:[]};a.a=r},rSjf:function(t,a,e){"use strict";(function(t){a.a={layout:"main",computed:{filteredList:function(){var t=this;return""==this.search?this.rules:this.rules.filter(function(a){return a.loyaltyrule.toLowerCase().includes(t.search.toLowerCase())})}},data:function(){return{loading:!0,search:"",status:"",formData:{merchID:"",loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:"",status:"True"},options:[{id:"True",text:"Activate"},{id:"False",text:"Deactivate"}],errorData:{loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:""},editData:{merchID:"",loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:"",status:"True",id:""},rules:[]}},methods:{saveLoyaltyRule:function(){var a=this;this.validateAddRule()||(t("#submitBtn").attr("disabled",!0).html("Creating...please wait"),this.$store.dispatch("loyalty-rule/createRule",this.formData).then(function(e){if(t("#submitBtn").attr("disabled",!1).html("+ Create loyalty rule"),"True"===e.data.status)return a.$toast.success(e.data.message),a.closeAddModal(),void a.listLoyaltyRule();a.$toast.error(e.data.message)}).catch(function(e){t("#submitBtn").attr("disabled",!1).html("+ Create loyalty rule"),a.$toast.error("An error occurred")}))},updateLoyaltyRule:function(){var a=this;t("#updateBtn").attr("disabled",!0).html("Updating...please wait"),this.$store.dispatch("loyalty-rule/updateRule",this.editData).then(function(e){if(t("#updateBtn").attr("disabled",!1).html("+ Update loyalty rule"),e.data.status)return a.$toast.success(e.data.message),a.closeEditModal(),void a.listLoyaltyRule();a.$toast.error(e.data.message)}).catch(function(e){t("#updateBtn").attr("disabled",!1).html("+ Update loyalty rule"),a.$toast.error("An error occurred")})},closeAddModal:function(){this.clearErrorData(),this.formData.loyaltyrule="",this.formData.rewardpoint="",this.formData.amountspent="",this.formData.startdate="",this.formData.endate="",this.formData.status="True",UIkit.modal("#add-loyalty-rule").toggle("hide")},closeEditModal:function(){this.editData={merchID:"",loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:"",status:"True"},UIkit.modal("#edit-loyalty-rule").toggle("hide")},clearErrorData:function(){this.errorData={loyaltyrule:"",rewardpoint:"",amountspent:"",startdate:"",endate:"",status:"True"}},validateAddRule:function(){return this.clearErrorData(),""===this.formData.loyaltyrule?(this.errorData.loyaltyrule=!0,!0):""===this.formData.rewardpoint?(this.errorData.rewardpoint=!0,!0):""===this.formData.amountspent?(this.errorData.amountspent=!0,!0):""===this.formData.startdate?(this.errorData.startdate=!0,!0):""===this.formData.endate&&(this.errorData.endate=!0,!0)},listLoyaltyRule:function(){var t=this;this.$store.dispatch("loyalty-rule/listRules",this.formData.merchID).then(function(a){t.loading=!1,t.rules=a.data.data})},displayCreateModal:function(){UIkit.modal("#add-loyalty-rule").toggle()},checkDate:function(t){return this.$moment().isAfter(t)},editLoyalty:function(t){this.editData={merchID:this.formData.merchID,loyaltyrule:t.loyaltyrule,rewardpoint:t.rewardpoint,amountspent:t.amountspent,startdate:t.startdate,endate:t.endate,status:!0===t.status?"True":"False",id:t.id},this.status=!0===t.status?"True":"False",UIkit.modal("#edit-loyalty-rule").toggle()}},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.listLoyaltyRule()}}}).call(a,e("7t+N"))}});