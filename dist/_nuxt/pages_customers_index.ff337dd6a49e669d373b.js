webpackJsonp([16],{"9vVH":function(t,e,a){var s=a("niOs");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("6d0d280f",s,!1,{sourceMap:!1})},CukP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("oqIh"),r=a("i5+B"),i=!1;var o=function(t){i||a("9vVH")},n=a("VU/8")(s.a,r.a,!1,o,"data-v-736b99a2",null);n.options.__file="pages/customers/index.vue",e.default=n.exports},M2Sb:function(t,e,a){"use strict";e.a={layout:"main",props:["headers","value","date"],methods:{previous:function(){if(""!==this.headers.Prev){var t=+this.value-1;t<0?t=1:(this.$emit("input",t),this.$emit("go"))}},next:function(){if(""!==this.headers.Next){var t=+this.value+1;this.$emit("input",t),this.$emit("go")}}}}},hYtS:function(t,e,a){"use strict";var s=a("M2Sb"),r=a("zTfd"),i=a("VU/8")(s.a,r.a,!1,null,null,null);i.options.__file="components/Pagination.vue",e.a=i.exports},"i5+B":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("overlay-scrollbars",{staticClass:"main-content-wrap"},[a("div",{staticClass:"d-flx-alc-jsb page-extras"},[a("div",{},[a("button",{staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:t.openModal}},[t._v("\n          Add Customer\n        ")])]),a("div",{staticClass:"search-filter d-flx-alc-jfe"},[a("label",{staticClass:"search-w-icon"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{type:"text",placeholder:"Search"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#search"}})])]),a("download-excel",{staticClass:"btn btn--primary",attrs:{id:"download",fetch:t.fetchData,fields:t.json_fields,"before-generate":t.startDownload,"before-finish":t.finishDownload,worksheet:"My Worksheet",name:"customer-list-report.xls"}},[t._v("\n          Export\n        ")])],1)]),a("pagination",{ref:"pagination",attrs:{headers:t.headers},on:{go:t.getCustomerReport},model:{value:t.formData.page,callback:function(e){t.$set(t.formData,"page",e)},expression:"formData.page"}}),a("div",{staticClass:"inner-main-wrapper"},[a("overlay-scrollbars",{staticClass:"table-wrapper no-deco"},[a("figcaption",{staticClass:"sr"},[t._v("\n          A table showing information of categories\n        ")]),a("table",{staticClass:"table-content"},[a("thead",{},[a("tr",[a("th",{staticClass:"large-space column-name"},[t._v("Name")]),a("th",{staticClass:"large-space column-name"},[t._v("Phone Number")]),a("th",{staticClass:"larger-space column-name"},[t._v("Email Address")]),a("th",{staticClass:"medium-space"},[t._v("Transaction Value(â‚¦)")]),a("th",{staticClass:"medium-space"},[t._v("Total orders")]),a("th",{staticClass:"small-space"},[t._v("Action")])])]),a("tbody",{staticClass:"tablebody"},[t.loading?a("tr",[a("td",{attrs:{colspan:"8"}},[t._v("Loading...please wait")])]):t._e(),t.loading||t.filteredList!=[]?t._e():a("tr",[a("td",{attrs:{colspan:"8"}},[t._v("No customer record have been added")])]),t._l(t.filteredList,function(e,s){return!t.loading&&t.filteredList.length>0?a("tr",{key:s,staticStyle:{cursor:"pointer"}},[a("td",{staticClass:"column-name",on:{click:function(a){return t.viewCustomerDetails(e)}}},[t._v(t._s(e.firstname)+" "+t._s(e.lastname))]),a("td",{staticClass:"column-name",on:{click:function(a){return t.viewCustomerDetails(e)}}},[t._v(t._s(e.phonenumber))]),a("td",{staticClass:"email column-name",on:{click:function(a){return t.viewCustomerDetails(e)}}},[t._v(t._s(e.emailaddress))]),a("td",{on:{click:function(a){return t.viewCustomerDetails(e)}}},[t._v(t._s(t.formatPrice(e.totalamountspent)))]),a("td",[t._v(t._s(e.totalordermade))]),a("td",{staticClass:"d-flx-alc"},[a("button",{staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:function(a){return t.editRecord(e)}}},[t._v("\n                Edit \n              ")])])]):t._e()})],2)]),a("div",{attrs:{id:"edit-customer","uk-modal":"",container:"#parent-component"}},[a("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),a("div",{staticClass:"modal-header"},[a("h2",[t._v("Edit Customer")]),a("p",[t._v("Edit customer name, phone number and email")])]),a("form",{on:{submit:function(e){return e.preventDefault(),t.updateCustomer.apply(null,arguments)}}},[a("overlay-scrollbars",{class:"modal-body",attrs:{"uk-overflow-auto":""}},[a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("First name")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.updateData.firstname,expression:"updateData.firstname"}],attrs:{type:"text",placeholder:"",required:""},domProps:{value:t.updateData.firstname},on:{input:function(e){e.target.composing||t.$set(t.updateData,"firstname",e.target.value)}}})])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Last name")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.updateData.lastname,expression:"updateData.lastname"}],attrs:{type:"text",placeholder:"",required:""},domProps:{value:t.updateData.lastname},on:{input:function(e){e.target.composing||t.$set(t.updateData,"lastname",e.target.value)}}})])])]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Phone Number "),a("span",{staticStyle:{color:"red","font-size":"12px"}},[t._v("(must be 11-digits e.g: 08080000000)")])]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.updateData.phonenumber,expression:"updateData.phonenumber"}],attrs:{type:"tel",placeholder:"",pattern:"^[0]\\d{10}$",required:""},domProps:{value:t.updateData.phonenumber},on:{input:function(e){e.target.composing||t.$set(t.updateData,"phonenumber",e.target.value)}}})])])]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Email Address")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.updateData.emailaddress,expression:"updateData.emailaddress"}],attrs:{type:"email",placeholder:""},domProps:{value:t.updateData.emailaddress},on:{input:function(e){e.target.composing||t.$set(t.updateData,"emailaddress",e.target.value)}}})])])]),a("div",{staticClass:"d-flx-alc-jfe mt-3"},[a("button",{staticClass:"btn btn-no-fill",attrs:{type:"button"},on:{click:t.cancelUpdate}},[t._v("\n                    Cancel\n                  ")]),a("button",{staticClass:"btn btn--primary ml-1",attrs:{type:"submit",id:"updateBtn"}},[t._v("\n                    Update Customer\n                  ")])])])],1)])]),a("div",{attrs:{id:"delete-text","uk-modal":"","data-uk-modal":"{target:'#delete-text',bgclose:false}",container:"#parent-component"}},[a("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical small-modal"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button"},on:{click:t.cancelDelete}},[t._v("X")]),a("div",{staticClass:"modal-header d-flx"},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#co-delete"}})]),a("div",{staticClass:"ml-1"},[a("h2",[t._v("Delete Customer?")]),a("p",[t._v("Please confirm you really want to delete this customer, this action cannot be undone.")])])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"d-flx-alc-jc mt-3"},[a("button",{staticClass:"btn btn-no-fill",on:{click:t.cancelDelete}},[t._v("\n                    Cancel\n                  ")]),a("button",{staticClass:"btn btn-error ml-2",attrs:{id:"deleteBtn"},on:{click:t.doDeleteCustomer}},[t._v("\n                    Delete\n                  ")])])])])])])],1),a("div",{attrs:{id:"add-customer","uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.closeModal}}),a("div",{staticClass:"modal-header"},[a("h2",[t._v("Add Customers")]),a("p",[t._v("Enter the details to create customers.")])]),a("form",{staticClass:"mt-2",on:{submit:function(e){return e.preventDefault(),t.createCustomer.apply(null,arguments)}}},[t._l(t.customerdata.customerdetails,function(e,s){return a("div",{key:s},[a("div",{staticClass:"flex-width-1-2 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("First Name")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.firstname,expression:"input.firstname"}],attrs:{type:"text",required:""},domProps:{value:e.firstname},on:{input:function(a){a.target.composing||t.$set(e,"firstname",a.target.value)}}})])]),a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v(" Last Name")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.lastname,expression:"input.lastname"}],attrs:{type:"text",required:""},domProps:{value:e.lastname},on:{input:function(a){a.target.composing||t.$set(e,"lastname",a.target.value)}}})])])]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Phone Number "),a("span",{staticStyle:{color:"red","font-size":"12px"}},[t._v("(must be 11-digits e.g: 08080000000)")])]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.phonenumber,expression:"input.phonenumber"}],attrs:{type:"tel",pattern:"^[0]\\d{10}$",required:""},domProps:{value:e.phonenumber},on:{input:function(a){a.target.composing||t.$set(e,"phonenumber",a.target.value)}}})])])]),a("div",{staticClass:"flex-width-1-1 less-gp"},[a("label",{staticClass:"form-input"},[a("span",{staticClass:"form-input__label"},[t._v("Email Address ")]),a("div",{staticClass:"form-input__input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.emailaddress,expression:"input.emailaddress"}],attrs:{type:"email"},domProps:{value:e.emailaddress},on:{input:function(a){a.target.composing||t.$set(e,"emailaddress",a.target.value)}}})])])]),a("button",{directives:[{name:"show",rawName:"v-show",value:s==t.customerdata.customerdetails.length-1,expression:"i == customerdata.customerdetails.length-1"}],staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:function(e){return t.addNew(s)}}},[t._v("\n             Add more\n            ")]),a("button",{directives:[{name:"show",rawName:"v-show",value:s||!s&&t.customerdata.customerdetails.length>1,expression:"i || ( !i && customerdata.customerdetails.length > 1)"}],staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:function(e){return t.remove(s)}}},[t._v(" remove")])])}),a("div",{staticClass:"d-flx-alc-jfe mt-5"},[a("button",{staticClass:"btn btn-no-fill",attrs:{type:"button",id:"cancelBtn"},on:{click:t.closeModal}},[t._v("\n              Cancel\n            ")]),a("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"submitBtn",type:"submit"}},[t._v("\n              Create Customer\n            ")])])],2)])])],1)};s._withStripped=!0;var r={render:s,staticRenderFns:[]};e.a=r},niOs:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".btn--primary[data-v-736b99a2]{background-color:#089628;color:#fff;min-width:15px!important}.btn--danger[data-v-736b99a2]{background-color:#dc3545;color:#fff;min-width:15px!important;left:5px;position:relative}.btn[data-v-736b99a2]{padding:9.6px 19.2px;padding:.6rem 1.2rem}",""])},oqIh:function(t,e,a){"use strict";(function(t){var s=a("hYtS");e.a={components:{Pagination:s.a},layout:"main",computed:{screenSize:function(){return screen.availWidth>400},filteredList:function(){var t=this;return""==this.search?this.reports:this.reports.filter(function(e){return null!=e.firstname&&e.firstname.toLowerCase().includes(t.search.toLowerCase())?e.firstname.toLowerCase().includes(t.search.toLowerCase()):null!=e.lastname&&e.lastname.toLowerCase().includes(t.search.toLowerCase())?e.lastname.toLowerCase().includes(t.search.toLowerCase()):void 0})},json_fields:function(){this.$moment;return{"Customer Name":{callback:function(t){return t.firstname+" "+t.lastname}},"Phone Number":"phonenumber",Email:"emailaddress","Total Order":"totalordermade","Total Amount Spent":"totalamountspent","Wallet Balance":"walletbalance","Loyalty Points":"loyaltybalance"}}},data:function(){return{loading:!0,reports:[],search:"",api:"usersreport/getCustomerReport",date:"",formData:{merchID:"",page:1,startdate:"",enddate:""},updateData:{id:"",firstname:"",merchID:"",lastname:"",phonenumber:"",emailaddress:""},customerdata:{merchID:"",customerdetails:[{firstname:"",lastname:"",phonenumber:"",emailaddress:""}]},deleteData:{id:""},headers:{Next:"",Prev:"",count:0,total:0,pagenum:1}}},methods:{deleteCustomer:function(e){this.deleteData.id=e,t("#delete-text").addClass("uk-open").show()},editRecord:function(t){this.updateData={id:t.id,firstname:t.firstname,lastname:t.lastname,phonenumber:t.phonenumber,emailaddress:t.emailaddress},UIkit.modal("#edit-customer").toggle()},cancelUpdate:function(){this.updateData={firstname:"",merchID:"",lastname:"",emailaddress:"",phonenumber:""},UIkit.modal("#edit-customer").toggle("hide")},addNew:function(){this.customerdata.customerdetails.push({firstname:"",lastname:"",phonenumber:"",emailaddress:""})},cancelDelete:function(){this.deleteData={id:""},t("#delete-text").removeClass("uk-open").hide()},doDeleteCustomer:function(){var e=this;t("#deleteBtn").attr("disabled",!0).html("Deleting..please wait"),this.$store.dispatch("customer/deleteCustomer",this.deleteData).then(function(a){if(t("#deleteBtn").attr("disabled",!1).html("Delete"),a.data.status)return e.$toast.success(a.data.message),e.getCustomerReport(),void e.cancelDelete();e.$toast.error("An error occurred and the operation was terminated")}).catch(function(a){e.$toast.error("An error occurred and the operation was terminated"),t("#deleteBtn").attr("disabled",!1).html("Delete"),console.log(a)})},updateCustomer:function(){var e=this;t("#updateBtn").html("Updating Customer....please wait"),t("#updateBtn").attr("disabled",!0),this.$store.dispatch("customer/updateCustomer",this.updateData).then(function(a){if(t("#updateBtn").attr("disabled",!1).html("+ Update Customer"),a.data.status)return e.$toast.success(a.data.message),e.getCustomerReport(),void e.cancelUpdate();e.$toast.error("An error occurred")}).catch(function(e){t("#updateBtn").attr("disabled",!1).html("+ Update rider"),console.log(e)})},remove:function(t){this.customerdata.customerdetails.splice(t,1)},closeModal:function(){UIkit.modal("#add-customer").toggle("hide")},openModal:function(){UIkit.modal("#add-customer").toggle()},createCustomer:function(){var e=this;this.customerdata=this.customerdata.customerdetails;var a={merchID:this.user.id,customerdetails:this.customerdata};t("#submitBtn").attr("disabled",!0).html("Saving....please wait"),this.$store.dispatch("customer/saveCustomer",a).then(function(a){if(t("#submitBtn").attr("disabled",!1).html("+ Create Customer"),a.data.status)return e.$toast.success(a.data.message),e.getCustomerReport(),e.closeModal(),void e.$router.push("/customers");e.$toast.error(a.data.message)}).catch(function(t){console.log(t)})},searchReport:function(){if(this.formData.page=1,this.search)return this.formData.search=this.search,void this.getSearch()},getSearch:function(){var t=this;this.loading=!0,this.$store.dispatch("customers/searchCustomer",this.formData).then(function(e){if(e.data.status)return t.reports=e.data.data,void 0!=e.data.data&&e.data.data.length>0&&(t.$refs.pagination.$forceUpdate(),t.setHeaders(e.data.data,e)),void(t.loading=!1)})},nextData:function(){if(""!==this.headers.Next){var t=+this.formData.page+1;this.formData.page=t,this.getCustomerReport()}},previousData:function(){if(""!==this.headers.Prev){var t=+this.formData.page-1;t<0?this.formData.page=1:(this.formData.page=t,this.getCustomerReport())}},getCustomerReport:function(){var t=this;if(this.search)return this.formData.search=this.search,void this.getSearch();this.loading=!0,""!==this.date&&null!=this.date[0]?(this.formData.startdate=this.$moment(this.date[0]).format("YYYY-MM-DD"),this.formData.enddate=this.$moment(this.date[1]).format("YYYY-MM-DD")):(this.formData.startdate="",this.formData.enddate=""),this.formData.export="",this.$store.dispatch("usersreport/getCustomerReport",this.formData).then(function(e){if(e.data.status)return t.reports=e.data.data.data,void 0!=e.data.data.data&&e.data.data.data.length>0&&t.setHeaders(e.data.data.data,e.data.data),void(t.loading=!1);t.loading=!1,t.$toast.error("An error occurred! Please try again")}).catch(function(e){t.loading=!1,t.$toast.error("An error occurred "+e)})},sortCustomerReport:function(){var t=this;this.loading=!0,""!==this.date&&null!=this.date[0]?(this.formData.startdate=this.$moment(this.date[0]).format("YYYY-MM-DD"),this.formData.enddate=this.$moment(this.date[1]).format("YYYY-MM-DD")):(this.formData.startdate="",this.formData.enddate=""),this.formData.export="",this.formData.page=1,this.$store.dispatch("usersreport/getCustomerReport",this.formData).then(function(e){if(e.data.status)return t.reports=e.data.data.data,void 0!=e.data.data.data&&e.data.data.data.length>0&&t.setHeaders(e.data.data.data,e.data.data),void(t.loading=!1);t.loading=!1,t.$toast.error("An error occurred! Please try again")}).catch(function(e){t.loading=!1,t.$toast.error("An error occurred "+e)})},viewCustomerDetails:function(t){localStorage.removeItem("customer"),this.$store.dispatch("customers/setCustomer",t),this.$router.push("/customers/details/"+t.id)}},mounted:function(){this.formData.merchID=this.user.role?this.user.merchID:this.user.id,this.loading=!0,this.getCustomerReport()},beforeRouteEnter:function(t,e,a){var s=JSON.parse(localStorage.getItem("user"));void 0==s.role||s.rolepermission&&s.rolepermission[0].customer.viewcustomer?a():(alert("You have not been permitted to view this page"),a({path:"/dashboard"}))}}}).call(e,a("7t+N"))},zTfd:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flx-alc-jsb page-extras"},[a("div",{staticClass:"drop-down page-drop"},[a("button",{staticClass:"btn-text ",attrs:{type:"button"}},[t._v("\n          Showing "),a("span",[t._v(" "+t._s(t.showing)+" ")]),t._v(" of "),a("span",[t._v(" "+t._s(void 0!=this.headers.Count?this.headers.Count:0)+" ")])])]),a("div",{staticClass:"d-flx-alc"},[t.date&&"object"==typeof t.date?a("div",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.date[0])+" - "+t._s(t.date[1]))]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:"string"==typeof t.date,expression:"typeof date == 'string'"}],staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.date)+" ")]),a("button",{staticClass:"btn btn-icon smallsvg",on:{click:t.previous}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#arrow-right"}})])]),a("button",{staticClass:"btn btn-icon smallsvg",on:{click:t.next}},[a("svg",[a("use",{attrs:{href:"/uploads/icons.svg#arrow-left"}})])])])])};s._withStripped=!0;var r={render:s,staticRenderFns:[]};e.a=r}});