webpackJsonp([15],{"8+Bc":function(t,a,s){var e=s("NIvh");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);s("rjj0")("233f3bc7",e,!1,{sourceMap:!1})},M2Sb:function(t,a,s){"use strict";a.a={layout:"main",props:["headers","value","date"],methods:{previous:function(){if(""!==this.headers.Prev){var t=+this.value-1;t<0?t=1:(this.$emit("input",t),this.$emit("go"))}},next:function(){if(""!==this.headers.Next){var t=+this.value+1;this.$emit("input",t),this.$emit("go")}}}}},NIvh:function(t,a,s){(t.exports=s("FZ+f")(!1)).push([t.i,"table td[data-v-5fedd882]{padding:15px 10px}",""])},hUWs:function(t,a,s){"use strict";(function(t){var e=s("woOf"),i=s.n(e),o=s("hYtS");a.a={components:{Pagination:o.a},layout:"main",computed:{searchs:{get:function(){return this.search},set:function(t){this.search=t}},filteredList:function(){return void 0!=this.customers?this.customers:[]}},data:function(){return{search:"",loading:!0,customers:[],customersList:[],customerDetails:{},formData:{id:[],title:"",body:"",type:"push"},getData:{id:0,page:1},errorData:{id:!1,title:!1,body:!1},options:[{id:"",text:"Select Customers"},{id:"all",text:"All Customers"}],settings:{width:"100%"},headers:{Next:"",Prev:"",count:0,total:0,pagenum:1}}},methods:{searchReport:function(){if(this.getData.page=1,this.search)return this.getData.search=this.search,void this.getSearch()},getSearch:function(){var t=this;this.loading=!0,this.$store.dispatch("customers/searchCustomer",this.getData).then(function(a){if(a.data.status)return t.customers=a.data.data.data,void 0!=a.data.data.data&&a.data.data.data.length>0&&(console.log("something"),t.$refs.pagination.$forceUpdate(),t.setHeaders(a.data.data.data,a.data.data)),void(t.loading=!1)})},formatNumber:function(t){return(new Intl.NumberFormat).format(t)},getCustomersUnpaginated:function(){var t=this;this.$store.dispatch("customer/getCustomersAll",this.getData).then(function(a){a.data.status&&t.setCustomers(a.data.data)})},getAllCustomers:function(){var t=this;if(this.search)return this.getData.search=this.search,void this.getSearch();this.$store.dispatch("customer/getCustomers",this.getData).then(function(a){if(a.data.status)return void 0!=a.data.data.data&&a.data.data.data.length>0&&(t.customers=a.data.data.data,t.setHeaders(a.data.data.data,a.data.data)),void(t.loading=!1);t.loading=!1,t.$toast.error("An error occurred")}).catch(function(a){t.loading=!1,t.$toast.error("An error occurred while retrieving data")})},setCustomers:function(t){var a=this;t.forEach(function(t){var s={id:t.id,text:t.firstname+" "+t.lastname};a.customersList.push(s),a.options.push(s)})},submitNotification:function(){var a=this;if(!this.validateData()){console.log(this.formData.id);var s=this.formData.id;s.includes("all")&&(s=[],this.customersList.forEach(function(t){s.push(t.id)}),console.log(s));var e=s.map(function(t){return parseInt(t,10)}),o=i()({},this.formData);o.id=e,t("#submitBtn").attr("disabled",!0).html("Sending...Please wait"),"push"===o.type&&(o.url="/API/pushnotification/"),this.$store.dispatch("customer/sendPushNotification",o).then(function(s){if(console.log(s),t("#submitBtn").attr("disabled",!1).html("Send Notification"),s.data.status)return a.$toast.success("notification sent"),void a.closeModal();a.$toast.error(s.data.message)}).catch(function(s){t("#submitBtn").attr("disabled",!1).html("Send Notification"),a.$toast.error("An error occurred")})}},transactionHistory:function(t){localStorage.removeItem("setDetails"),UIkit.modal("#customer-details").toggle(),this.$store.dispatch("customer/clearDetails"),this.$store.dispatch("customer/setDetails",t),this.$router.push("/customers/transaction")},viewDetails:function(t){localStorage.removeItem("customer"),this.$store.dispatch("customers/setCustomer",t),this.$router.push("/customers/details/"+t.id)},displayModal:function(){UIkit.modal("#send-push-notification").toggle()},closeModal:function(){this.clearData(),UIkit.modal("#send-push-notification").toggle()},clearData:function(){this.formData={id:[],title:"",body:"",type:"push"}},clearError:function(){this.errorData={id:!1,title:!1,body:!1,type:!1}},validateData:function(){return this.clearError(),this.formData.id.length<1?(this.errorData.id=!0,!0):""===this.formData.title?(this.errorData.title=!0,!0):""===this.formData.body?(this.errorData.body=!0,!0):""===this.formData.type&&(this.errorData.type=!0,!0)},suspendAccount:function(t){UIkit.modal("#suspend-customer").toggle()}},mounted:function(){this.getData.id=this.user.role?this.user.merchID:this.user.id,this.getAllCustomers(),this.getCustomersUnpaginated()}}}).call(a,s("7t+N"))},hYtS:function(t,a,s){"use strict";var e=s("M2Sb"),i=s("zTfd"),o=s("VU/8")(e.a,i.a,!1,null,null,null);o.options.__file="components/Pagination.vue",a.a=o.exports},r9SW:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s("hUWs"),i=s("ts+Z"),o=!1;var n=function(t){o||s("8+Bc")},r=s("VU/8")(e.a,i.a,!1,n,"data-v-5fedd882",null);r.options.__file="pages/notifications/index.vue",a.default=r.exports},"ts+Z":function(t,a,s){"use strict";var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("overlay-scrollbars",{staticClass:"main-content-wrap"},[s("div",{staticClass:"d-flx-alc-jsb page-extras"},[s("p",{staticClass:"fw-medium font-16"}),s("div",{staticClass:"search-filter d-flx-alc-jfe"},[s("label",{staticClass:"search-w-icon"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchs,expression:"searchs"}],attrs:{type:"text",placeholder:"Search"},domProps:{value:t.searchs},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.searchReport.apply(null,arguments)},input:function(a){a.target.composing||(t.searchs=a.target.value)}}}),s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#search"}})])]),s("div",{staticClass:"drop-down auth-drop"}),t.user.rolepermission&&t.user.rolepermission[0].notifications.sendnotifications||t.isMerchant?s("button",{staticClass:"btn btn--primary",attrs:{type:"button"},on:{click:t.displayModal}},[s("svg",[s("use",{attrs:{"xlink:href":"/uploads/icons.svg#bell-btn"}})]),s("span",{staticClass:"ml-1"},[t._v("Send Notifications")])]):t._e()])]),s("pagination",{ref:"pagination",attrs:{headers:t.headers},on:{go:t.getAllCustomers},model:{value:t.getData.page,callback:function(a){t.$set(t.getData,"page",a)},expression:"getData.page"}}),s("div",{attrs:{id:"parent-component"}},[s("div",{attrs:{id:"send-push-notification","uk-modal":"","data-uk-modal":"{target:'#send-push-notification',bgclose:false}",container:"#parent-component"}},[s("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal"},[s("button",{staticClass:"uk-modal-close-default",attrs:{type:"button"},on:{click:t.closeModal}},[t._v("X")]),s("div",{staticClass:"modal-header"},[s("h2",[t._v(" Notification message")]),s("p",[t._v("Create notifications to be sent to your customers.")])]),s("form",{on:{submit:function(a){return a.preventDefault(),t.submitNotification.apply(null,arguments)}}},[s("overlay-scrollbars",{staticClass:"modal-body"},[s("div",{staticClass:"form-input"},[s("label",{staticClass:"form-input__label"},[t._v("Notification Medium")]),s("div",{staticClass:"form-input__input"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.type,expression:"formData.type"}],on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"type",a.target.multiple?s:s[0])}}},[s("option",{attrs:{value:""}},[t._v("Select a notification type")]),s("option",{attrs:{value:"push"}},[t._v("Push Notifications")]),s("option",{attrs:{value:"email"}},[t._v("SMS")]),s("option",{attrs:{value:"email"}},[t._v("Email")])])]),t.errorData.type?s("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a medium")]):t._e()]),s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[t._v("Notification Subject")]),s("div",{staticClass:"form-input__input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.title,expression:"formData.title"}],attrs:{type:"text",required:"",placeholder:"Buy 2 and get one free!"},domProps:{value:t.formData.title},on:{input:function(a){a.target.composing||t.$set(t.formData,"title",a.target.value)}}})]),t.errorData.title?s("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a title")]):t._e()]),s("div",{staticClass:"form-input"},[s("label",{staticClass:"form-input__label"},[t._v("Notification body")]),s("div",{staticClass:"form-input__input"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.body,expression:"formData.body"}],attrs:{rows:"5",placeholder:"Enter"},domProps:{value:t.formData.body},on:{input:function(a){a.target.composing||t.$set(t.formData,"body",a.target.value)}}})]),t.errorData.body?s("span",{staticClass:"form-input__error-msg"},[t._v("Please enter a message body")]):t._e()]),s("div",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[t._v("Select customers")]),s("div",{staticClass:"form-input__input"},[s("select2-multiple-control",{attrs:{placeholder:"Select as least one customer",options:t.options,settings:t.settings},model:{value:t.formData.id,callback:function(a){t.$set(t.formData,"id",a)},expression:"formData.id"}})],1),t.errorData.id?s("span",{staticClass:"form-input__error-msg"},[t._v("Please select a customer")]):t._e()])]),s("div",{staticClass:"d-flx-alc-jfe mt-3"},[s("button",{staticClass:"btn btn-no-fill uk-modal-close",attrs:{type:"button"},on:{click:t.closeModal}},[t._v("\n              Cancel\n            ")]),s("button",{staticClass:"btn btn--primary ml-1",attrs:{id:"submitBtn",type:"submit"}},[t._v("\n              Send Notification\n            ")])])],1)])]),s("div",{attrs:{id:"customer-details","uk-modal":"","data-uk-modal":"{target:'#customer-details',bgclose:false}",container:"#parent-component"}},[s("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical modal review-modal"},[s("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),s("div",{staticClass:"modal-header"},[s("h2",[t._v("\n            Customer Details\n            "),s("span",{staticClass:"status delivered"},[t._v("Active")])])]),s("div",{staticClass:"modal-body p-3",attrs:{"uk-overflow-auto":""}},[s("h3",{staticClass:"uppercase co-grey fw-medium font-16 mb-2"},[t._v("Business information")]),s("div",{staticClass:"box-deco d-flx-alc-jc-fwp p-3"},[s("div",{staticClass:"avatar avatar-80"},[s("img",{attrs:{src:"/default_image.png",alt:""}})]),s("div",{staticClass:"flex-width-1-2 small-gap mt-5"},[s("div",[s("h4",{staticClass:"uppercase co-grey fw-normal font-16"},[t._v("\n                  Customer’s Name\n                ")]),s("p",{staticClass:"fw-normal font-18 co-rich-black"},[t._v(t._s(t.customerDetails.firstname)+" "+t._s(t.customerDetails.lastname))])]),s("div",[s("h4",{staticClass:"uppercase co-grey fw-normal font-16"},[t._v("\n                  Phone number\n                ")]),s("p",{staticClass:"fw-normal font-18 co-rich-black"},[t._v(t._s(t.customerDetails.phonenumber))])]),s("div",[s("h4",{staticClass:"uppercase co-grey fw-normal font-16"},[t._v("\n                  Email Address\n                ")]),s("p",{staticClass:"fw-normal font-18 co-rich-black"},[t._v("\n                  "+t._s(t.customerDetails.emailaddress)+"\n                ")])]),s("div",[s("h4",{staticClass:"uppercase co-grey fw-normal font-16"},[t._v("\n                  Home Address\n                ")]),s("p",{staticClass:"fw-normal font-18 co-rich-black"},[t._v("\n                  N/A\n                ")])])])]),s("div",{staticClass:"mt-5"},[s("h3",{staticClass:"uppercase co-grey fw-medium font-16 mb-2"},[t._v("Purchase information")]),s("div",{staticClass:"flex-width-1-2 small-gap  p-3 box-deco"},[s("div",[s("h4",{staticClass:"uppercase co-grey fw-normal font-16"},[t._v("\n                  No of Orders made\n                ")]),s("p",{staticClass:"fw-normal font-18 co-rich-black"},[t._v(t._s(t.formNumber(t.customerDetails.totalordermade)))])]),s("div",[s("h4",{staticClass:"uppercase co-grey fw-normal font-16"},[t._v("\n                  Total amount Spent\n                ")]),s("p",{staticClass:"fw-normal font-18 co-rich-black"},[t._v("₦ "+t._s(t.formatPrice(t.customerDetails.totalamountspent)))])])])])]),s("div",{staticClass:"modal-footer d-flx-alc-jfe"},[s("button",{staticClass:"btn btn-no-fill uk-modal-close"},[t._v("Cancel")]),s("button",{staticClass:"btn btn-error ml-1",attrs:{"uk-toggle":"target: #suspend-customer"}},[s("svg",[s("use",{attrs:{"xlink:href":"/uploads/icons.svg#warning"}})]),s("span",{staticClass:"ml-h"},[t._v("suspend")])]),s("a",{staticClass:"btn btn--primary ml-1",attrs:{href:"javascript:;"},on:{click:function(a){return t.transactionHistory(t.customerDetails)}}},[t._v("View Transaction History")])])])]),s("div",{attrs:{id:"suspend-customer","uk-modal":"","data-uk-modal":"{target:'#suspend-customer',bgclose:false}",container:"#parent-component"}},[s("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical small-modal"},[s("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),s("div",{staticClass:"modal-header d-flx"},[s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#suspend"}})]),s("div",{staticClass:"ml-1"},[s("h2",[t._v("Suspend Customer ?")]),s("p",{staticClass:"mt-1"},[t._v("You’re about to suspend"),s("span",{staticClass:"fw-medium"},[t._v(" Kehinde Ademola")]),t._v(". If suspended, this customer will not be able to make any purchases on Ntisa.")]),s("div",{staticClass:"my-1"},[s("label",{staticClass:"form-input"},[s("span",{staticClass:"form-input__label"},[t._v("Suspension Reason")]),s("div",{staticClass:"form-input__input"},[s("input",{attrs:{type:"text",placeholder:"State your suspension reason here"}})])])])])]),s("div",{staticClass:"d-flx-alc-jfe mt-3"},[s("button",{staticClass:"btn btn-no-fill uk-modal-close"},[t._v("\n            Cancel\n          ")]),s("button",{staticClass:"btn btn-error ml-2"},[t._v("\n            Suspend Customer\n          ")])])])]),s("div",{attrs:{id:"activate-customer","uk-modal":"","data-uk-modal":"{target:'#activate-customer',bgclose:false}",container:"#parent-component"}},[s("div",{staticClass:"uk-modal-dialog uk-margin-auto-vertical small-modal"},[s("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),s("div",{staticClass:"modal-header d-flx"},[s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#confirm"}})]),s("div",{staticClass:"ml-1"},[s("h2",[t._v("Activate Customer?")]),s("p",{staticClass:"mt-2"},[t._v("You’re about to activate "),s("span",{staticClass:"fw-medium"},[t._v(" Kehinde Ademola")]),t._v(".  This gives the customer access to Ntisa again")])])]),s("div",{staticClass:"d-flx-alc-jfe mt-3"},[s("button",{staticClass:"btn btn-no-fill uk-modal-close"},[t._v("\n            Cancel\n          ")]),s("button",{staticClass:"btn btn--primary ml-2"},[t._v("\n            Activate Customer\n          ")])])])])]),s("div",{staticClass:"inner-main-wrapper"},[s("overlay-scrollbars",{staticClass:"table-wrapper"},[s("figcaption",{staticClass:"sr"},[t._v("\n        A table showing information of customers\n      ")]),s("table",{staticClass:"table-content "},[s("thead",{},[s("tr",[s("th",{staticClass:"column-name"},[t._v("Customer Name")]),s("th",{staticClass:"column-name"},[t._v("Email address")]),s("th",{staticClass:"column-name"},[t._v("Phone Number")]),s("th",[t._v("Total Spent(₦)")]),s("th",{staticClass:"column-name"},[t._v("Signup Date")])])]),s("tbody",{staticClass:"tablebody"},[t.loading?s("tr",[s("td",{attrs:{colspan:"8"}},[t._v("Loading...please wait")])]):t._e(),!t.loading&&t.filteredList.length<1?s("tr",[s("td",{attrs:{colspan:"8"}},[t._v("No customer details")])]):t._e(),t._l(t.filteredList,function(a,e){return!t.loading&&t.filteredList.length>0?s("tr",{key:e,staticClass:"over"},[s("td",{staticClass:"column-name",on:{click:function(s){return t.viewDetails(a)}}},[s("div",{staticClass:"avatar-wtext"},[s("span",[t._v(t._s(a.firstname)+" "+t._s(a.lastname))])])]),s("td",{staticClass:"email column-name",on:{click:function(s){return t.viewDetails(a)}}},[t._v(t._s(a.emailaddress))]),s("td",{staticClass:"column-name",on:{click:function(s){return t.viewDetails(a)}}},[t._v(t._s(a.phonenumber))]),s("td",{on:{click:function(s){return t.viewDetails(a)}}},[t._v(" "+t._s(t.formatPrice(a.totalamountspent)))]),s("td",{staticClass:"column-name",on:{click:function(s){return t.viewDetails(a)}}},[t._v(t._s(t.$moment(a.created_at).format("Do MMMM, YYYY")))])]):t._e()})],2)])])],1)],1)};e._withStripped=!0;var i={render:e,staticRenderFns:[]};a.a=i},zTfd:function(t,a,s){"use strict";var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"d-flx-alc-jsb page-extras"},[s("div",{staticClass:"drop-down page-drop"},[s("button",{staticClass:"btn-text ",attrs:{type:"button"}},[t._v("\n          Showing "),s("span",[t._v(" "+t._s(t.showing)+" ")]),t._v(" of "),s("span",[t._v(" "+t._s(void 0!=this.headers.Count?this.headers.Count:0)+" ")])])]),s("div",{staticClass:"d-flx-alc"},[t.date&&"object"==typeof t.date?s("div",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.date[0])+" - "+t._s(t.date[1]))]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:"string"==typeof t.date,expression:"typeof date == 'string'"}],staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.date)+" ")]),s("button",{staticClass:"btn btn-icon smallsvg",on:{click:t.previous}},[s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#arrow-right"}})])]),s("button",{staticClass:"btn btn-icon smallsvg",on:{click:t.next}},[s("svg",[s("use",{attrs:{href:"/uploads/icons.svg#arrow-left"}})])])])])};e._withStripped=!0;var i={render:e,staticRenderFns:[]};a.a=i}});